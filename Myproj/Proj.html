<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Proj</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Proj</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Arith.Arith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.Reals.RIneq</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.Reals.R_sqrt</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.micromega.Lra</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">Lemma</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">PF</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Pbasics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Pconstruct</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">vec</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Point</span>) : <span class="id" title="var">Point</span> := (<span class="id" title="var">B</span> - <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_2</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">p1</span> - <span class="id" title="var">p2</span> + <span class="id" title="var">p2</span> = <span class="id" title="var">p1</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pplus_eq_reg_r</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">A</span> + <span class="id" title="var">P</span> = <span class="id" title="var">B</span> + <span class="id" title="var">P</span> -&gt; <span class="id" title="var">A</span> = <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>; <span class="id" title="tactic">split</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pplus_eq_reg_r'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">A</span> = <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span> + <span class="id" title="var">P</span> = <span class="id" title="var">B</span> + <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> " print_goal " :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- ?<span class="id" title="var">x</span> =&gt; <span class="id" title="tactic">idtac</span> <span class="id" title="var">x</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">Oelim</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">idtac</span> "Firstly, unfold predicts and eliminit the O:";<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> = <span class="id" title="var">O</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">Midpoint</span>, <span class="id" title="var">Xcollin</span>, <span class="id" title="var">collin</span>, <span class="id" title="var">Perpendicular</span>, <span class="id" title="var">Parall</span>, <span class="id" title="var">ParallE</span>, <span class="id" title="var">Ptraingle_median</span>, <span class="id" title="var">vec</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pminus_O_r</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pplus_0_l</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">idtac</span> "and now we begin to proof the goal: "; <span class="id" title="var">print_goal</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">Midpoint</span>, <span class="id" title="var">Xcollin</span>, <span class="id" title="var">collin</span>, <span class="id" title="var">Perpendicular</span>, <span class="id" title="var">Parall</span>, <span class="id" title="var">Ptraingle_median</span>, <span class="id" title="var">vec</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pminus_O_r</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">repeat</span>  <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pplus_0_l</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pplus_0_r</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Unit_right</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pplus_minus</span>; <span class="id" title="tactic">auto</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="var">print_goal</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">l</span>, <span class="id" title="var">B</span> = <span class="id" title="var">l</span> * <span class="id" title="var">A</span> ) -&gt; <span class="id" title="var">collin</span> <span class="id" title="var">O</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> /\ <span class="id" title="tactic">exists</span> <span class="id" title="var">m</span>, <span class="id" title="var">vec</span> <span class="id" title="var">O</span> <span class="id" title="var">B</span> = <span class="id" title="var">m</span> * (<span class="id" title="var">vec</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">collin</span>, <span class="id" title="var">vec</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">split</span>; <span class="id" title="var">Oelim</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property2_1</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">A</span> + <span class="id" title="var">B</span> = <span class="id" title="var">C</span> -&gt; <span class="id" title="var">Parall</span> <span class="id" title="var">A</span> <span class="id" title="var">O</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property2_2</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">M</span>, <span class="id" title="var">A</span> + <span class="id" title="var">B</span> = 2 * <span class="id" title="var">M</span> -&gt; <span class="id" title="var">Midpoint</span> <span class="id" title="var">M</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property2_3</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">P</span>, <span class="id" title="var">A</span> + <span class="id" title="var">B</span> = 3 * <span class="id" title="var">P</span> -&gt; <span class="id" title="var">Ptraingle_median</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">B</span> - <span class="id" title="var">A</span> = <span class="id" title="var">vec</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">vec</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property3'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">P</span>, <span class="id" title="var">B</span> - <span class="id" title="var">A</span> = <span class="id" title="var">t</span> * <span class="id" title="var">P</span> -&gt; <span class="id" title="var">t</span> = 1%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">Parall</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Oelim</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property4_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = (<span class="id" title="var">u</span> + <span class="id" title="var">v</span>) * <span class="id" title="var">F</span> -&gt; <span class="id" title="var">u</span> * (<span class="id" title="var">A</span> - <span class="id" title="var">F</span>) = <span class="id" title="var">v</span> * (<span class="id" title="var">F</span> - <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Lemma.Pmult_minus_distr_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Pplus_eq_reg_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">P</span> := <span class="id" title="var">v</span> * <span class="id" title="var">B</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_2</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> :  <span class="id" title="var">u</span> * <span class="id" title="var">A</span> - <span class="id" title="var">u</span> * <span class="id" title="var">F</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = <span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> - <span class="id" title="var">u</span> * <span class="id" title="var">F</span>). <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>, <span class="id" title="var">H</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pquan_distr_r</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="var">Point</span>,<br/>
&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">A</span> - <span class="id" title="var">B</span>) · <span class="id" title="var">C</span>)%<span class="id" title="var">Point</span> = (<span class="id" title="var">A</span> · <span class="id" title="var">C</span>)- (<span class="id" title="var">B</span> · <span class="id" title="var">C</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pminus</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">B</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">C</span>. <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pquan_comm</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> · <span class="id" title="var">B</span> = <span class="id" title="var">B</span> · <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">B</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pquan_distr_l</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="var">Point</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">A</span> · <span class="id" title="var">C</span>)- (<span class="id" title="var">B</span> · <span class="id" title="var">C</span>)=((<span class="id" title="var">A</span> - <span class="id" title="var">B</span>) · <span class="id" title="var">C</span>)%<span class="id" title="var">Point</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_distr_r</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Definition Collin (l : Z) (O A B : Point) :=
  B = Pmults l A. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">first_exam</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">N</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span> <span class="id" title="var">G</span> <span class="id" title="var">M</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">N</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">M</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">P</span> <span class="id" title="var">C</span> <span class="id" title="var">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">collin</span> <span class="id" title="var">A</span> <span class="id" title="var">G</span> <span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX</span> : 2 * <span class="id" title="var">N</span> + 1 * <span class="id" title="var">B</span> = 2 * <span class="id" title="var">P</span> + 1 * <span class="id" title="var">C</span> ).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H1</span>, <span class="id" title="var">H0</span>. <span class="id" title="var">PusingR_f</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">u</span>:=2) (<span class="id" title="var">v</span>:=1%<span class="id" title="var">R</span>) (<span class="id" title="var">r</span>:=2) (<span class="id" title="var">s</span>:=1%<span class="id" title="var">R</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H1</span>, <span class="id" title="var">Unit_right</span>, <span class="id" title="var">Padd_comm</span>, <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HX</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Pmult_div</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HX</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HX</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (2/3)%<span class="id" title="var">R</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">Example2</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">M</span> <span class="id" title="var">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Parall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">M</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">M</span> <span class="id" title="var">D</span> <span class="id" title="var">P</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C</span> = 3 * <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX</span> : 2 * <span class="id" title="var">O</span> + 1 * <span class="id" title="var">C</span> = 2 * <span class="id" title="var">M</span> + 1 * <span class="id" title="var">D</span>).<br/>
&nbsp;&nbsp;{  <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>, &lt;- <span class="id" title="var">H1</span>. <span class="id" title="var">PusingR_f</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">u</span>:=2) (<span class="id" title="var">v</span>:=1%<span class="id" title="var">R</span>) (<span class="id" title="var">r</span>:=2) (<span class="id" title="var">s</span>:=1%<span class="id" title="var">R</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HCP</span> :  2 * <span class="id" title="var">O</span> + 1 * <span class="id" title="var">C</span> = <span class="id" title="var">C</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">PusingR_f</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HCP</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HX</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HX</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rmove</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span> - <span class="id" title="var">b</span> = 0 &lt;-&gt; <span class="id" title="var">a</span> = <span class="id" title="var">b</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">tri_3_heights'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">H</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Perpendicular</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">H</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Perpendicular</span> <span class="id" title="var">B</span> <span class="id" title="var">H</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Perpendicular</span> <span class="id" title="var">C</span> <span class="id" title="var">H</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_distr_r</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_comm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_distr_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_comm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmove</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_comm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_distr_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmove</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_comm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pquan_comm</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">moveterm_1</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> + <span class="id" title="var">B</span> = <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span> = <span class="id" title="var">C</span> - <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Pplus</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pminus</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">B</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>: <span class="id" title="var">R</span>, (<span class="id" title="var">r1</span> + <span class="id" title="var">r2</span> - <span class="id" title="var">r2</span> = <span class="id" title="var">r1</span>)%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">lra</span>. } <span class="id" title="tactic">simpl</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">moveterm_2</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> + <span class="id" title="var">B</span> = <span class="id" title="var">C</span> -&gt; <span class="id" title="var">B</span> = <span class="id" title="var">C</span> - <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pplus</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pminus</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">A</span>, <span class="id" title="var">B</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HX</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>: <span class="id" title="var">R</span>, (<span class="id" title="var">r1</span> + <span class="id" title="var">r2</span> - <span class="id" title="var">r1</span> = <span class="id" title="var">r2</span>)%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">lra</span>. } <span class="id" title="tactic">simpl</span>; <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">Moveas</span> <span class="id" title="var">A</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">idtac</span> "Move";<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span>: <span class="id" title="var">A</span> + ?<span class="id" title="var">B</span> = <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <span class="id" title="var">moveterm_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span>: ?<span class="id" title="var">B</span> + <span class="id" title="var">A</span> = <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <span class="id" title="var">moveterm_2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">l1</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">A</span> + (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>) = <span class="id" title="var">A</span> + <span class="id" title="var">B</span> - <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">l2</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">A</span> - (<span class="id" title="var">B</span> + <span class="id" title="var">C</span>) = <span class="id" title="var">A</span> - <span class="id" title="var">B</span> - <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">l3</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">A</span> = <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span> - <span class="id" title="var">B</span> = <span class="id" title="var">C</span> - <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">p23_exam4</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Parall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">A</span> <span class="id" title="var">M</span> <span class="id" title="var">P</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">D</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> <span class="id" title="var">N</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">B</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Moveas</span> <span class="id" title="var">B</span>; <span class="id" title="var">Moveas</span> <span class="id" title="var">P</span>;<span class="id" title="var">Moveas</span> <span class="id" title="var">Q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mol</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">R</span> := <span class="id" title="var">sqrt</span> (<span class="id" title="var">Px</span> <span class="id" title="var">B</span> - <span class="id" title="var">Px</span> <span class="id" title="var">A</span>)^2 + (<span class="id" title="var">Py</span> <span class="id" title="var">B</span> - <span class="id" title="var">Py</span> <span class="id" title="var">A</span>)^2.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">distance</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>) : <span class="id" title="var">R</span> := <span class="id" title="var">sqrt</span> (<span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">B</span> - <span class="id" title="var">A</span>))%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pmult_eq_compat_r</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">B</span> -&gt; <span class="id" title="var">r</span> * <span class="id" title="var">A</span> = <span class="id" title="var">r</span> * <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pmult_distr_r</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span> <span class="id" title="var">r</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">P</span>: <span class="id" title="var">Point</span>), <span class="id" title="var">l</span> * (<span class="id" title="var">r</span> * <span class="id" title="var">P</span>) = (<span class="id" title="var">l</span> * <span class="id" title="var">r</span>) * <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rsqrt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <span class="id" title="var">R</span>, (<span class="id" title="var">l</span> * <span class="id" title="var">l</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">l</span>².<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rsqr_pow2</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Psquarel</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">l</span>: <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">l</span> * <span class="id" title="var">A</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">l</span>² * <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">A</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pnorm_sqr</span>, <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">rsqrt</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rsqrt_l'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> : <span class="id" title="var">R</span>, 0 &lt;= <span class="id" title="var">m</span>  -&gt; <span class="id" title="var">sqrt</span> (<span class="id" title="var">l</span>² * <span class="id" title="var">m</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">sqrt</span> <span class="id" title="var">l</span>² * <span class="id" title="var">sqrt</span> <span class="id" title="var">m</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">sqrt_mult</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rle_0_sqr</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rsqrt_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> : <span class="id" title="var">R</span>, 0 &lt;= <span class="id" title="var">m</span>  -&gt; <span class="id" title="var">sqrt</span> (<span class="id" title="var">l</span>² * <span class="id" title="var">m</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">Rabs</span> <span class="id" title="var">l</span> * <span class="id" title="var">sqrt</span> <span class="id" title="var">m</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rsqrt_l'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l</span> := <span class="id" title="var">l</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">sqrt_Rsqr_abs</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">rle</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">r</span>: <span class="id" title="var">R</span>, 0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">r</span> -&gt; <span class="id" title="var">r</span> &lt;&gt; 0%<span class="id" title="var">R</span>. <span class="id" title="keyword">Search</span> <span class="id" title="var">Rlt</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">rle_inv</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">r</span>: <span class="id" title="var">R</span>, 0%<span class="id" title="var">R</span> &lt;= <span class="id" title="var">r</span> -&gt; 0%<span class="id" title="var">R</span> &lt;= (/<span class="id" title="var">r</span>)%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property4_2</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">F</span> - <span class="id" title="var">B</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * (<span class="id" title="var">A</span> - <span class="id" title="var">F</span>) = <span class="id" title="var">v</span> * (<span class="id" title="var">F</span> - <span class="id" title="var">B</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> * /<span class="id" title="var">distance</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">Rabs</span> (<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">distance</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Pmult_eq_compat_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r</span>:=(/<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pmult_distr_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_comm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Unit_right</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Psquarel</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rlt_le</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rsqrt_l</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l</span> := ((/ <span class="id" title="var">u</span> * <span class="id" title="var">v</span>))%<span class="id" title="var">R</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rle</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">Hr</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">Hn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rlt_le</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sqrt_div</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">y</span> := (<span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">F</span> - <span class="id" title="var">B</span>))%<span class="id" title="var">R</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">sqrt_1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_1_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_comm</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hn</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property4</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">F</span> - <span class="id" title="var">B</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = (<span class="id" title="var">u</span> + <span class="id" title="var">v</span>) * <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> * /<span class="id" title="var">distance</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">Rabs</span> (<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">property4_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">property4_2</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property6</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">A</span> · <span class="id" title="var">B</span> = <span class="id" title="var">B</span> · <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">A</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">B</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">negP_n</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>: <span class="id" title="var">R</span>, -(<span class="id" title="var">x</span>, <span class="id" title="var">y</span>) = ((-<span class="id" title="var">x</span>)%<span class="id" title="var">R</span>, (-<span class="id" title="var">y</span>)%<span class="id" title="var">R</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pneg</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">OutP</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> := <span class="id" title="var">B</span> - <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;  A @ B  " := (<span class="id" title="var">OutP</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">Point_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property8</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, (<span class="id" title="var">A</span> @ <span class="id" title="var">B</span>) = (- (<span class="id" title="var">B</span> @ <span class="id" title="var">A</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">OutP</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">removeb</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">A</span> + (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>) = <span class="id" title="var">A</span> + <span class="id" title="var">B</span> - <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property9_1</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span>*<span class="id" title="var">A</span> + <span class="id" title="var">v</span>*<span class="id" title="var">B</span> = (<span class="id" title="var">u</span>+<span class="id" title="var">v</span>)*<span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span>*(<span class="id" title="var">A@P</span>) + <span class="id" title="var">v</span>*(<span class="id" title="var">B@P</span>) = (<span class="id" title="var">u</span>+<span class="id" title="var">v</span>)*(<span class="id" title="var">C@P</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">OutP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property9_2</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span>*<span class="id" title="var">A</span> + <span class="id" title="var">v</span>*<span class="id" title="var">B</span> = (<span class="id" title="var">u</span>+<span class="id" title="var">v</span>)*<span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span>*(<span class="id" title="var">P@A</span>) + <span class="id" title="var">v</span>*(<span class="id" title="var">P@B</span>) = (<span class="id" title="var">u</span>+<span class="id" title="var">v</span>)*(<span class="id" title="var">P@C</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">OutP</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property10_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = <span class="id" title="var">r</span> * <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * (<span class="id" title="var">A</span> @ <span class="id" title="var">P</span>) + <span class="id" title="var">v</span> * (<span class="id" title="var">B</span> @ <span class="id" title="var">P</span>) = <span class="id" title="var">r</span> * (<span class="id" title="var">C</span> @ <span class="id" title="var">P</span>) + (<span class="id" title="var">u</span> + <span class="id" title="var">v</span> - <span class="id" title="var">r</span>) * <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">OutP</span>. <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Lemma.Pmult_minus_distr_l</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property10_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = <span class="id" title="var">r</span> * <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * (<span class="id" title="var">P</span> @ <span class="id" title="var">A</span>) + <span class="id" title="var">v</span> * (<span class="id" title="var">P</span> @ <span class="id" title="var">B</span>) = <span class="id" title="var">r</span> * (<span class="id" title="var">P</span> @ <span class="id" title="var">C</span>) - (<span class="id" title="var">u</span> + <span class="id" title="var">v</span> - <span class="id" title="var">r</span>) * <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">OutP</span>. <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Lemma.Pmult_minus_distr_l</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> = <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> = <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> = (- <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_4</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, (- <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> = (- <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_4'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_4''</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> = (- <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_5</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, (- <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> = (- <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_6</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> = (- <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_abs</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>) = <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_6</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rabs_Ropp</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_abs'</span> :<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>) = <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">property11_4'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rabs_Ropp</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property11_abs''</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>) = <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_4''</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rabs_Ropp</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Psdistr</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">Px</span> <span class="id" title="var">A</span> * <span class="id" title="var">Py</span> <span class="id" title="var">B</span> + <span class="id" title="var">u</span> * <span class="id" title="var">Px</span> <span class="id" title="var">B</span> * <span class="id" title="var">Py</span> <span class="id" title="var">C</span> + <span class="id" title="var">u</span> * <span class="id" title="var">Px</span> <span class="id" title="var">C</span> * <span class="id" title="var">Py</span> <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">u</span> * <span class="id" title="var">Px</span> <span class="id" title="var">A</span> * <span class="id" title="var">Py</span> <span class="id" title="var">C</span> - <span class="id" title="var">u</span> * <span class="id" title="var">Px</span> <span class="id" title="var">B</span> * <span class="id" title="var">Py</span> <span class="id" title="var">A</span> - <span class="id" title="var">u</span> * <span class="id" title="var">Px</span> <span class="id" title="var">C</span> * <span class="id" title="var">Py</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Psdistr'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">s</span> (<span class="id" title="var">u</span>*<span class="id" title="var">A</span>) <span class="id" title="var">B</span> <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property12</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = (<span class="id" title="var">u</span>+<span class="id" title="var">v</span>) * <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> + <span class="id" title="var">v</span> * <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span> = ((<span class="id" title="var">u</span> + <span class="id" title="var">v</span>) * <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Psdistr</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">u</span> := (<span class="id" title="var">u</span>+<span class="id" title="var">v</span>)%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span>: ((<span class="id" title="var">u</span> + <span class="id" title="var">v</span>) * <span class="id" title="var">Px</span> <span class="id" title="var">Q</span> * <span class="id" title="var">Py</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> = ((<span class="id" title="var">u</span> + <span class="id" title="var">v</span>) * <span class="id" title="var">Py</span> <span class="id" title="var">C</span> * <span class="id" title="var">Px</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hr</span>: ((<span class="id" title="var">u</span> + <span class="id" title="var">v</span>) * <span class="id" title="var">Px</span> <span class="id" title="var">P</span> * <span class="id" title="var">Py</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> = ((<span class="id" title="var">u</span> + <span class="id" title="var">v</span>) * <span class="id" title="var">Py</span> <span class="id" title="var">C</span>  * <span class="id" title="var">Px</span> <span class="id" title="var">P</span>)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>, <span class="id" title="var">Hr</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H0</span>. <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property13</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = <span class="id" title="var">r</span> * <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> + <span class="id" title="var">v</span> * <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> = <span class="id" title="var">r</span> * <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> + (<span class="id" title="var">u</span> + <span class="id" title="var">v</span> - <span class="id" title="var">r</span>) * <span class="id" title="var">s</span> <span class="id" title="var">O</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Psdistr</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">u</span>:=<span class="id" title="var">r</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span>: (<span class="id" title="var">r</span> * <span class="id" title="var">Px</span> <span class="id" title="var">Q</span> * <span class="id" title="var">Py</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">r</span> * <span class="id" title="var">Py</span> <span class="id" title="var">C</span> * <span class="id" title="var">Px</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hr</span>: (<span class="id" title="var">r</span> * <span class="id" title="var">Px</span> <span class="id" title="var">P</span> * <span class="id" title="var">Py</span> <span class="id" title="var">C</span> )%<span class="id" title="var">R</span> = (<span class="id" title="var">r</span> * <span class="id" title="var">Py</span> <span class="id" title="var">C</span> * <span class="id" title="var">Px</span> <span class="id" title="var">P</span>)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hr</span>; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H0</span>. <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Example7</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">P</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">B</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Parall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ParallE</span> <span class="id" title="var">E</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">P</span> @ <span class="id" title="var">A</span>) + (<span class="id" title="var">P</span> @ <span class="id" title="var">C</span>) = 2 * (<span class="id" title="var">P</span> @ <span class="id" title="var">E</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">ParallE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H0</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Unit_right</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span> := (<span class="id" title="var">P@A</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Unit_right</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span> := (<span class="id" title="var">P@C</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">property9_2</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Unit_right</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eqPoint</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> : <span class="id" title="var">Point</span>), <span class="id" title="var">A</span> = <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span> = <span class="id" title="var">D</span> -&gt; (<span class="id" title="var">A</span> + <span class="id" title="var">C</span>)%<span class="id" title="var">Point</span> = (<span class="id" title="var">B</span> + <span class="id" title="var">D</span>)%<span class="id" title="var">Point</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Point</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_0</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">p1</span> <span class="id" title="var">p2</span>: <span class="id" title="var">Point</span>), <span class="id" title="var">p1</span> = <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">l</span> * <span class="id" title="var">p1</span> = <span class="id" title="var">l</span> * <span class="id" title="var">p2</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">p1</span> <span class="id" title="var">p2</span> <span class="id" title="var">p3</span> <span class="id" title="var">p4</span>: <span class="id" title="var">Point</span>), <span class="id" title="var">p1</span> + <span class="id" title="var">p2</span> = <span class="id" title="var">p3</span> + <span class="id" title="var">p4</span> -&gt; <span class="id" title="var">l</span> * <span class="id" title="var">p1</span> + <span class="id" title="var">l</span> * <span class="id" title="var">p2</span> = <span class="id" title="var">l</span> * <span class="id" title="var">p3</span> + <span class="id" title="var">l</span> * <span class="id" title="var">p4</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Pmult_add_distr_l</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_div</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">p1</span> <span class="id" title="var">p2</span>: <span class="id" title="var">Point</span>),(<span class="id" title="var">l</span> &lt;&gt; 0)%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">l</span> * <span class="id" title="var">p1</span> = <span class="id" title="var">l</span> * <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">p1</span> = <span class="id" title="var">p2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Unit_right'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span> := <span class="id" title="var">p1</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Unit_right'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span> := <span class="id" title="var">p2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r</span>:=<span class="id" title="var">l</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_comm</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pscal_assoc</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_div_1</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">p1</span> <span class="id" title="var">p2</span> <span class="id" title="var">p3</span> <span class="id" title="var">p4</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">l</span> &lt;&gt; 0)%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">l</span> * <span class="id" title="var">p1</span> + <span class="id" title="var">l</span> * <span class="id" title="var">p2</span> = <span class="id" title="var">l</span> * <span class="id" title="var">p3</span> + <span class="id" title="var">l</span> * <span class="id" title="var">p4</span>  -&gt; <span class="id" title="var">p1</span> + <span class="id" title="var">p2</span> = <span class="id" title="var">p3</span> + <span class="id" title="var">p4</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Pmult_add_distr_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_div</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l</span> := <span class="id" title="var">l</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_2'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">p1</span> + <span class="id" title="var">p2</span> - <span class="id" title="var">p2</span> = <span class="id" title="var">p1</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_3</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">p1</span> - <span class="id" title="var">p2</span> + <span class="id" title="var">p1</span> = <span class="id" title="var">p1</span> + <span class="id" title="var">p1</span> - <span class="id" title="var">p2</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_4</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">p1</span> + (- <span class="id" title="var">p2</span>) = <span class="id" title="var">p1</span> - <span class="id" title="var">p2</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_5</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">p1</span> - <span class="id" title="var">p2</span> = - <span class="id" title="var">p2</span> + <span class="id" title="var">p1</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_6</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span> <span class="id" title="var">p3</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">p1</span> - <span class="id" title="var">p3</span> = <span class="id" title="var">p2</span> - <span class="id" title="var">p3</span> -&gt; <span class="id" title="var">p1</span> = <span class="id" title="var">p2</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>; <span class="id" title="tactic">split</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_7</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p1</span> <span class="id" title="var">p2</span> <span class="id" title="var">p3</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">p1</span> = <span class="id" title="var">p2</span> -&gt; <span class="id" title="var">p1</span> - <span class="id" title="var">p3</span> = <span class="id" title="var">p2</span> - <span class="id" title="var">p3</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_8</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">p</span>: <span class="id" title="var">Point</span>), (-<span class="id" title="var">l</span>)%<span class="id" title="var">R</span> * <span class="id" title="var">p</span> = -(<span class="id" title="var">l</span> * <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pminus_O</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span>, <span class="id" title="var">A</span> - <span class="id" title="var">A</span> = <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Example3_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> <span class="id" title="var">P</span> <span class="id" title="var">B</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C</span> - <span class="id" title="var">A</span> = 3 * (<span class="id" title="var">P</span>-<span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3 * (<span class="id" title="var">B</span> - <span class="id" title="var">A</span>) = 5 * (<span class="id" title="var">Q</span> - <span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">D</span> - <span class="id" title="var">P</span> = <span class="id" title="var">B</span> - <span class="id" title="var">D</span> .<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">eqPoint</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hm</span> : (1 + 5)%<span class="id" title="var">R</span> = (3 + 3)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pscal_distr_R_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Unit_right'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span> := <span class="id" title="var">C</span>); <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_div_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. 2: <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Pplus_eq_reg_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">P</span> := <span class="id" title="var">D</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Pplus_eq_reg_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">P</span> := <span class="id" title="var">P</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_2</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Padd_comm</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">z1</span>:=<span class="id" title="var">B</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Example3_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> <span class="id" title="var">P</span> <span class="id" title="var">B</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C</span> - <span class="id" title="var">A</span> = 3 * (<span class="id" title="var">P</span>-<span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3 * (<span class="id" title="var">B</span> - <span class="id" title="var">A</span>) = 5 * (<span class="id" title="var">Q</span> - <span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;5 * (<span class="id" title="var">D</span> - <span class="id" title="var">Q</span>) = <span class="id" title="var">C</span> - <span class="id" title="var">D</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">eqPoint</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hm</span> : (1 + 5)%<span class="id" title="var">R</span> = (3 + 3)%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lra</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Lemma.Pmult_minus_distr_l</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span>:=5).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Pplus_eq_reg_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">P</span> := <span class="id" title="var">D</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_2</span>. <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Pplus_eq_reg_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">P</span>:=5*<span class="id" title="var">Q</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Unit_right'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">C</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eqPoint_minus</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> : <span class="id" title="var">Point</span>, <span class="id" title="var">A</span> = <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span> = <span class="id" title="var">D</span> -&gt; <span class="id" title="var">A</span> - <span class="id" title="var">C</span> = <span class="id" title="var">B</span> - <span class="id" title="var">D</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Example3_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> <span class="id" title="var">P</span> <span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C</span> - <span class="id" title="var">A</span> = 3 * (<span class="id" title="var">P</span> - <span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3 * (<span class="id" title="var">B</span> - <span class="id" title="var">A</span>) = 5 * (<span class="id" title="var">Q</span> - <span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3 * (<span class="id" title="var">R</span> - <span class="id" title="var">B</span>) = <span class="id" title="var">R</span> - <span class="id" title="var">C</span> .<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">eqPoint_minus</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hm</span> : (3 + (-1))%<span class="id" title="var">R</span> = (5 + (-3))%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pscal_distr_R_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_5</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_6</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p3</span> := <span class="id" title="var">R2</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_2'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hn</span> :  5 * <span class="id" title="var">Q</span> + -3 * <span class="id" title="var">P</span> = 5 * <span class="id" title="var">Q</span> - 3 * <span class="id" title="var">P</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_7</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p3</span> := 3*<span class="id" title="var">B</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_2'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>. <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hx</span> : 3 * <span class="id" title="var">B</span> - <span class="id" title="var">C</span> = 3 * <span class="id" title="var">B</span> + -1 * <span class="id" title="var">C</span>). <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : 5 * <span class="id" title="var">Q</span> + -3 * <span class="id" title="var">P</span> = 5 * <span class="id" title="var">Q</span> - 3 * <span class="id" title="var">P</span>). <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hx</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Example3_4</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> <span class="id" title="var">P</span> <span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C</span> - <span class="id" title="var">A</span> = 3 * (<span class="id" title="var">P</span> - <span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3 * (<span class="id" title="var">B</span> - <span class="id" title="var">A</span>) = 5 * (<span class="id" title="var">Q</span> - <span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;3 * (<span class="id" title="var">Q</span> - <span class="id" title="var">P</span>) = 2 * (<span class="id" title="var">R</span> - <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">eqPoint_minus</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hm</span> : (3 + (-1))%<span class="id" title="var">R</span> = (5 + (-3))%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pscal_distr_R_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_6</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p3</span>:= 3*(<span class="id" title="var">Q</span>-<span class="id" title="var">P</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pminus_O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_7</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p3</span>:=(5*<span class="id" title="var">Q</span> + -3*<span class="id" title="var">P</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pminus_O</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hm</span>. <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_6</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p3</span>:= 5 * <span class="id" title="var">Q</span> + -3 * <span class="id" title="var">P</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pminus_O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_7</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p3</span>:=(5*<span class="id" title="var">Q</span>-3*<span class="id" title="var">P</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pminus_O</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H1</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">triangle</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>) : <span class="id" title="keyword">Prop</span> := ~ <span class="id" title="var">collin</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Elim_9</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>, <span class="id" title="var">B</span> + <span class="id" title="var">C</span> = 2 * <span class="id" title="var">D</span> -&gt; 1/2 * (<span class="id" title="var">B</span> + <span class="id" title="var">C</span>) = <span class="id" title="var">D</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Elim_10</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">A</span> + <span class="id" title="var">B</span>) = (<span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">A</span> + <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">B</span> + 2 * (<span class="id" title="var">A</span> · <span class="id" title="var">B</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Elim11</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">A</span> + <span class="id" title="var">B</span> = <span class="id" title="var">C</span> -&gt; <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">A</span> + <span class="id" title="var">B</span>)  = <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Elim12</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">A</span> + <span class="id" title="var">B</span> = <span class="id" title="var">C</span> -&gt; (<span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">A</span> + <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">B</span> + 2 * (<span class="id" title="var">A</span> · <span class="id" title="var">B</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Elim13</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>, (2 * (<span class="id" title="var">B</span> · <span class="id" title="var">C</span>))%<span class="id" title="var">R</span> = (((1/2) * <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">B</span> + <span class="id" title="var">C</span>))%<span class="id" title="var">R</span> - (1/2 * <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>)))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Elim14</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>: <span class="id" title="var">Point</span>,((1 / 2 * <span class="id" title="var">Pnorm_sqr</span> (2 * <span class="id" title="var">D</span>) - 1 / 2 * <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>)))%<span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (2 * <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">D</span> - 1 / 2 * <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Elim15</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>: <span class="id" title="var">R</span>, <span class="id" title="var">A</span> + <span class="id" title="var">B</span> + (<span class="id" title="var">C</span> - <span class="id" title="var">D</span>) = <span class="id" title="var">A</span> + <span class="id" title="var">B</span> + <span class="id" title="var">C</span> - <span class="id" title="var">D</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Elim16</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>:<span class="id" title="var">Point</span>, (<span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">B</span> + <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">C</span> + (2 * <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">D</span> - 1 / 2 * <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>)))%<span class="id" title="var">R</span> = <span class="id" title="var">Pnorm_sqr</span> (2 * <span class="id" title="var">D</span>) -&gt; (2 * <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">B</span> + <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">C</span> - 1 / 2 * <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>))%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Example5_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>: <span class="id" title="var">Point</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triangle</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">D</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(2 * <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">D</span>-<span class="id" title="var">A</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">B</span> + <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">C</span> - (1/2 * <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>))%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">Hn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Elim12</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim13</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim14</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>) (<span class="id" title="var">C</span>:=<span class="id" title="var">C</span>) (<span class="id" title="var">D</span>:=<span class="id" title="var">D</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Elim16</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Perpend_prop2</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">R</span>), <span class="id" title="var">A</span> · (<span class="id" title="var">l</span> * <span class="id" title="var">B</span>) = (<span class="id" title="var">l</span> * (<span class="id" title="var">A</span> · <span class="id" title="var">B</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Perpend_prop2'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">R</span>), (<span class="id" title="var">l</span> * <span class="id" title="var">A</span>) · <span class="id" title="var">B</span> = (<span class="id" title="var">l</span> * (<span class="id" title="var">A</span> · <span class="id" title="var">B</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Perpend_prop</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Point</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">R</span>), <span class="id" title="var">A</span> · <span class="id" title="var">B</span> = 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">A</span> · (<span class="id" title="var">l</span> * <span class="id" title="var">B</span>) = 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Perpend_prop3</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Point</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">R</span>), <span class="id" title="var">l</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; (<span class="id" title="var">l</span> * <span class="id" title="var">A</span>) · <span class="id" title="var">B</span> = 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">A</span> · <span class="id" title="var">B</span> = 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop2'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rmult_integral</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Perpend_prop3'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Point</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">R</span>), <span class="id" title="var">l</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">A</span> · <span class="id" title="var">B</span> = 0%<span class="id" title="var">R</span> -&gt; (<span class="id" title="var">l</span> * <span class="id" title="var">A</span>) · <span class="id" title="var">B</span> = 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop2'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Perpend_prop4</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>, (<span class="id" title="var">A</span> - <span class="id" title="var">B</span>) · <span class="id" title="var">C</span> = (<span class="id" title="var">A</span> · <span class="id" title="var">C</span> - <span class="id" title="var">B</span> · <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Perpend_prop5</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="var">Point</span>, <span class="id" title="var">A</span> · (<span class="id" title="var">B</span> + <span class="id" title="var">C</span>) = (<span class="id" title="var">A</span> · <span class="id" title="var">B</span> + <span class="id" title="var">A</span> · <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Perpend_prop6</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">A</span> · (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>) = (<span class="id" title="var">A</span> · <span class="id" title="var">B</span> - <span class="id" title="var">A</span> · <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> " PerPendTac " := <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Example6</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">G</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span> <span class="id" title="var">H</span> <span class="id" title="var">L</span> : <span class="id" title="var">Point</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span> : <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triangle</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ptraingle_median</span> <span class="id" title="var">G</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ptraingle_H</span> <span class="id" title="var">H</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">D</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">E</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PonLine</span> <span class="id" title="var">L</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">u</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PonLine</span> <span class="id" title="var">M</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Perpendicular</span> <span class="id" title="var">A</span> <span class="id" title="var">L</span> <span class="id" title="var">D</span> <span class="id" title="var">H</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Perpendicular</span> <span class="id" title="var">B</span> <span class="id" title="var">M</span> <span class="id" title="var">E</span> <span class="id" title="var">H</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Perpendicular</span> <span class="id" title="var">C</span> <span class="id" title="var">N</span> <span class="id" title="var">F</span> <span class="id" title="var">H</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Perpendicular</span> <span class="id" title="var">M</span> <span class="id" title="var">L</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Ptraingle_H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H12</span>. <span class="id" title="var">Oelim</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">PonLine</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Perpend_prop</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l</span>:= 2%<span class="id" title="var">R</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H8</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Perpend_prop</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l</span>:=2%<span class="id" title="var">R</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Perpend_prop3</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l</span> := 3). <span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H7</span>, <span class="id" title="var">H8</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span>: (3*(<span class="id" title="var">v</span>*<span class="id" title="var">A</span>+(1-<span class="id" title="var">v</span>)*<span class="id" title="var">C</span>-(<span class="id" title="var">u</span>*<span class="id" title="var">B</span>+(1-<span class="id" title="var">u</span>)*<span class="id" title="var">C</span>))=3*<span class="id" title="var">v</span>*(<span class="id" title="var">A</span>-<span class="id" title="var">C</span>)-3*<span class="id" title="var">u</span>*(<span class="id" title="var">B</span>-<span class="id" title="var">C</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="var">PerPendTac</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hg</span>: 3*<span class="id" title="var">G</span>-<span class="id" title="var">A</span>=<span class="id" title="var">B</span>+<span class="id" title="var">C</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="var">PerPendTac</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop4</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hj</span>: (<span class="id" title="var">A</span> - (<span class="id" title="var">u</span> * <span class="id" title="var">B</span> + (1 - <span class="id" title="var">u</span>) * <span class="id" title="var">C</span>)) = <span class="id" title="var">A</span> - <span class="id" title="var">C</span> - <span class="id" title="var">u</span> * (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>)). <span class="id" title="var">PerPendTac</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hj</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H12</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H12</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop2'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hk</span>: (0 + (<span class="id" title="var">A</span> - <span class="id" title="var">C</span>) · <span class="id" title="var">C</span> - (<span class="id" title="var">u</span> * (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>) · (3 * <span class="id" title="var">G</span>) - <span class="id" title="var">u</span> * 0))%<span class="id" title="var">R</span> = ((<span class="id" title="var">A</span> - <span class="id" title="var">C</span>) · <span class="id" title="var">C</span> - (3 * <span class="id" title="var">u</span> * (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>)) · <span class="id" title="var">G</span>)%<span class="id" title="var">R</span>). { <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lra</span>. } <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hk</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> -&gt; <span class="id" title="var">Rmove</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H9</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq</span>: 3*<span class="id" title="var">G</span>-<span class="id" title="var">B</span>=<span class="id" title="var">A</span>+<span class="id" title="var">C</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="var">PerPendTac</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span>  (<span class="id" title="var">Hw</span>: (<span class="id" title="var">B</span> - (<span class="id" title="var">v</span> * <span class="id" title="var">A</span> + (1 - <span class="id" title="var">v</span>) * <span class="id" title="var">C</span>)) = <span class="id" title="var">B</span> - <span class="id" title="var">C</span> - <span class="id" title="var">v</span> * (<span class="id" title="var">A</span> - <span class="id" title="var">C</span>)). <span class="id" title="var">PerPendTac</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hw</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Perpend_prop2'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H12</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hr</span>: (0 + (<span class="id" title="var">B</span> - <span class="id" title="var">C</span>) · <span class="id" title="var">C</span> - (<span class="id" title="var">v</span> * (<span class="id" title="var">A</span> - <span class="id" title="var">C</span>) · (3 * <span class="id" title="var">G</span>) - <span class="id" title="var">v</span> * 0))%<span class="id" title="var">R</span> = ((<span class="id" title="var">B</span> - <span class="id" title="var">C</span>) · <span class="id" title="var">C</span> - (3 * <span class="id" title="var">v</span> * (<span class="id" title="var">A</span> - <span class="id" title="var">C</span>)) · <span class="id" title="var">G</span>)%<span class="id" title="var">R</span>). { <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pquantityprod</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lra</span>. } <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> -&gt; <span class="id" title="var">Rmove</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H10</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H10</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Perpend_prop4</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Ht</span>: (<span class="id" title="var">B</span> - <span class="id" title="var">C</span> - (<span class="id" title="var">A</span> - <span class="id" title="var">C</span>)) = -1 * (<span class="id" title="var">A</span> - <span class="id" title="var">B</span>)). <span class="id" title="var">PerPendTac</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Perpend_prop3'</span>. <span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property6</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Example8</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span> <span class="id" title="var">L</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>: <span class="id" title="var">Point</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triangle</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Midpoint</span> <span class="id" title="var">P</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C</span> - <span class="id" title="var">Q</span> = 2 * (<span class="id" title="var">Q</span> - <span class="id" title="var">A</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R'</span> - <span class="id" title="var">A</span> = 3 * (<span class="id" title="var">B</span> - <span class="id" title="var">R'</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> <span class="id" title="var">C</span> <span class="id" title="var">M</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">R'</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">Q</span> <span class="id" title="var">L</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">B</span> <span class="id" title="var">Q</span> <span class="id" title="var">N</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(252* <span class="id" title="var">s</span> <span class="id" title="var">L</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>)%<span class="id" title="var">R</span> = (25 * <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Oelim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Pplus_eq_reg_r'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">P</span>:= <span class="id" title="var">Q</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : <span class="id" title="var">C</span> = 3 * <span class="id" title="var">Q</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H1'</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H1''</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">Hs</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">Hs'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hf</span> : 2 * <span class="id" title="var">P</span> = 2 * <span class="id" title="var">P</span> + 2 * <span class="id" title="var">O</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Unit_right</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span> := <span class="id" title="var">B</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hg</span>: (2 + 2)%<span class="id" title="var">R</span> = (1 + 3)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg</span>. 2: <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Padd_comm</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Lemma.Pmult_minus_distr_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Pplus_eq_reg_r'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">P</span>:= 3 * <span class="id" title="var">R'</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Elim_2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hi</span> : <span class="id" title="var">R'</span> + 3 * <span class="id" title="var">R'</span> = 4 * <span class="id" title="var">R'</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hi</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H3'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_0</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l</span>:=3) <span class="id" title="tactic">in</span> <span class="id" title="var">H1'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pscal_distr_C_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hj</span>: 3 * (2 * <span class="id" title="var">P</span>) = 6 * <span class="id" title="var">P</span>). <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hj</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1'</span>. <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hf'</span>: 6 * <span class="id" title="var">P</span> = 6 * <span class="id" title="var">P</span> + 1 * <span class="id" title="var">O</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hf'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hg'</span> : (6 + 1)%<span class="id" title="var">R</span> = (4 + 3)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg'</span>. 2: <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1'</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Padd_comm</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Elim_0</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">l</span>:=2) <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hj'</span> : 2 * (4 * <span class="id" title="var">R'</span>) = 8 * <span class="id" title="var">R'</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hj'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hj''</span> : 2 * (3 * <span class="id" title="var">B</span>) = 6 * <span class="id" title="var">B</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hj''</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eqPoint</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:= 8 * <span class="id" title="var">R'</span>) (<span class="id" title="var">B</span> := 6 * <span class="id" title="var">B</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. 2: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Unit_right'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:= <span class="id" title="var">C</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hg''</span> : (8 + 1)%<span class="id" title="var">R</span> = (6 + 3)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H5</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg''</span>. 2: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hs'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg''</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hn'</span> : (6 + 3) * <span class="id" title="var">L</span> = 9 * <span class="id" title="var">L</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hn'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg''</span>. <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg''</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Unit_right</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:= <span class="id" title="var">C</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hg''</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HM</span> : (4 + 3) * <span class="id" title="var">M</span> = 7 * <span class="id" title="var">M</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HM</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg'</span>. <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hs'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HN</span> : (1 + 3) * <span class="id" title="var">N</span> = 4 * <span class="id" title="var">N</span>). <span class="id" title="var">PusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HN</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg</span>. <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hg</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HT</span> : <span class="id" title="var">M</span> = /7 * (3 * <span class="id" title="var">B</span> + 3 * <span class="id" title="var">C</span>)). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hg'</span>. <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HT'</span>: <span class="id" title="var">N</span> = /4 * (1 * <span class="id" title="var">B</span> + <span class="id" title="var">C</span>)). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hg</span>. <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HT''</span>: <span class="id" title="var">L</span> = /9 * (6 * <span class="id" title="var">B</span> + 1 * <span class="id" title="var">C</span>)). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hg''</span>. <span class="id" title="var">PusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HT</span>,<span class="id" title="var">HT'</span>,<span class="id" title="var">HT''</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pappus_1'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> <span class="id" title="var">r3</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">r2</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">r3</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">r1</span> = (<span class="id" title="var">r1</span> * /<span class="id" title="var">r2</span> * <span class="id" title="var">r2</span>* /<span class="id" title="var">r3</span> * <span class="id" title="var">r3</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_comm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_assoc</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_1_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_assoc</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_1_r</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pappus_1</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> <span class="id" title="var">r3</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">r2</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">r3</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">r1</span> = (<span class="id" title="var">r1</span> / <span class="id" title="var">r2</span> * <span class="id" title="var">r2</span> / <span class="id" title="var">r3</span> * <span class="id" title="var">r3</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Pappus_1'</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pappus_div</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> <span class="id" title="var">r3</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">r2</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">r3</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">r1</span> = ((<span class="id" title="var">r1</span> / <span class="id" title="var">r2</span>) * (<span class="id" title="var">r2</span> / <span class="id" title="var">r3</span>) * <span class="id" title="var">r3</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span>: (<span class="id" title="var">r1</span> / <span class="id" title="var">r2</span> * <span class="id" title="var">r2</span> / <span class="id" title="var">r3</span> * <span class="id" title="var">r3</span>)%<span class="id" title="var">R</span> = ((<span class="id" title="var">r1</span> / <span class="id" title="var">r2</span>) * (<span class="id" title="var">r2</span> / <span class="id" title="var">r3</span>) * <span class="id" title="var">r3</span>)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hs</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Pappus_1'</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Papus_2</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> <span class="id" title="var">Q</span>: <span class="id" title="var">Point</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>  &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> <span class="id" title="var">Q</span> * /<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> * <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> * /<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> * <span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Pappus_1</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">papus_3</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span>: <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = <span class="id" title="var">r</span> * <span class="id" title="var">C</span> + <span class="id" title="var">s'</span> * <span class="id" title="var">D</span> -&gt; (<span class="id" title="var">u</span> * <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> + <span class="id" title="var">v</span> * <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> = 0%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commonEdg'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> : <span class="id" title="var">R</span>)(<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> + <span class="id" title="var">v</span> * <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> = 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Xcollin0</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">papus_3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commonEdg''</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> : <span class="id" title="var">R</span>)(<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> * /<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> = (-<span class="id" title="var">v</span> */ <span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rinv_mult_r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">r</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">v</span>%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">r</span>%<span class="id" title="var">R</span> = (<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Rmult_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rinv_mult_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">r</span> * <span class="id" title="var">u</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">v</span>%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">r</span>%<span class="id" title="var">R</span> = (<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_mult_r</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_comm</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rinv_mult_m'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">s</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; (<span class="id" title="var">u</span> * <span class="id" title="var">r</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">v</span> * <span class="id" title="var">s</span>)%<span class="id" title="var">R</span> -&gt; (<span class="id" title="var">r</span> * /<span class="id" title="var">s</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_mult_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">u</span> := <span class="id" title="var">u</span>) (<span class="id" title="var">r</span> := <span class="id" title="var">r</span>) (<span class="id" title="var">v</span> := (<span class="id" title="var">v</span>*<span class="id" title="var">s</span>)%<span class="id" title="var">R</span>)<span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : (<span class="id" title="var">v</span> * <span class="id" title="var">s</span> * / <span class="id" title="var">u</span> * / <span class="id" title="var">s</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">v</span> * / <span class="id" title="var">u</span> * (<span class="id" title="var">s</span> * / <span class="id" title="var">s</span>))%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="var">lra</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rinv_mult_m</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">r</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">v</span> * <span class="id" title="var">s</span>)%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">s</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; (<span class="id" title="var">r</span> * /<span class="id" title="var">s</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_mult_m'</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rinv_mult_0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">s</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">r</span> + <span class="id" title="var">v</span> * <span class="id" title="var">s</span>)%<span class="id" title="var">R</span> = 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">r</span> * /<span class="id" title="var">s</span>)%<span class="id" title="var">R</span> = (-(<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>))%<span class="id" title="var">R</span> .<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rplus_eq_compat_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r</span> := (- <span class="id" title="var">v</span> * <span class="id" title="var">s</span>)%<span class="id" title="var">R</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> :(<span class="id" title="var">u</span> * <span class="id" title="var">r</span> + <span class="id" title="var">v</span> * <span class="id" title="var">s</span> + - <span class="id" title="var">v</span> * <span class="id" title="var">s</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">u</span> * <span class="id" title="var">r</span>)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rplus_0_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_mult_m</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="var">lra</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rinv_abs_0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">r</span> <span class="id" title="var">v</span> <span class="id" title="var">s</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">r</span> + <span class="id" title="var">v</span> * <span class="id" title="var">s</span>)%<span class="id" title="var">R</span> = 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">r</span> * /<span class="id" title="var">s</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">Rabs</span> ((<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>))%<span class="id" title="var">R</span> .<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_mult_0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rabs_Ropp</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sRabs</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> + <span class="id" title="var">v</span> * <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> = 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">Rabs</span> (<span class="id" title="var">v</span> * / <span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_abs_0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rabs_mult</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span>:= (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)) (<span class="id" title="var">y</span> := (/ (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rabs_Rinv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">distance_eq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> = <span class="id" title="var">distance</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property4'</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> * <span class="id" title="var">A</span> + <span class="id" title="var">v</span> * <span class="id" title="var">B</span> = (<span class="id" title="var">u</span> + <span class="id" title="var">v</span>) * <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; <span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">F</span> - <span class="id" title="var">B</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> * /<span class="id" title="var">distance</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">Rabs</span> (<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">property4_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">property4_2</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Psquare_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> : <span class="id" title="var">Point</span>, 0%<span class="id" title="var">R</span> &lt;= <span class="id" title="var">Pnorm_sqr</span> <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Psquare_le_p</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">Point</span>, <span class="id" title="var">A</span> &lt;&gt; <span class="id" title="var">B</span> -&gt; 0%<span class="id" title="var">R</span> &lt; (<span class="id" title="var">Pnorm_sqr</span> (<span class="id" title="var">A</span> - <span class="id" title="var">B</span>))%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commonEdg''</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span>: <span class="id" title="var">R</span>)(<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> */ <span class="id" title="var">distance</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> = <span class="id" title="var">Rabs</span> (<span class="id" title="var">v</span> * /<span class="id" title="var">u</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Xcollin0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">property4'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Psquare_le_p</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commonEdg_0</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> : <span class="id" title="var">R</span>)(<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> */ <span class="id" title="var">distance</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">sRabs</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg''</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, <span class="id" title="var">H'</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Xcollin0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H'</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CommonEdg_0</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> */ <span class="id" title="var">distance</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XCOLLIN</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">commonEdg_0</span>. 2: <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="var">Unshelve</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commonEdg_0'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> : <span class="id" title="var">R</span>)(<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> */ <span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">distance_eq</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:= <span class="id" title="var">F</span>) (<span class="id" title="var">B</span> := <span class="id" title="var">B</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg_0</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">u</span>:=<span class="id" title="var">u</span>) (<span class="id" title="var">v</span>:=<span class="id" title="var">v</span>) (<span class="id" title="var">r</span>:=<span class="id" title="var">r</span>) (<span class="id" title="var">s'</span>:=<span class="id" title="var">s'</span>);<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CommonEdg_0'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> */ <span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XCOLLIN</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">commonEdg_0'</span>. 2: <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="var">Unshelve</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">commonEdg</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> : <span class="id" title="var">R</span>)(<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> / <span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg_0'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">u</span>:=<span class="id" title="var">u</span>) (<span class="id" title="var">v</span>:=<span class="id" title="var">v</span>) (<span class="id" title="var">r</span>:=<span class="id" title="var">r</span>) (<span class="id" title="var">s'</span>:=<span class="id" title="var">s'</span>); <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CommonEdg</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span>: <span class="id" title="var">Point</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> / <span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">XCOLLIN</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">commonEdg</span>. 2: <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="var">Unshelve</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rdiv_inver_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span>/<span class="id" title="var">b</span>)%<span class="id" title="var">R</span>=<span class="id" title="var">c</span> -&gt; <span class="id" title="var">b</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">a</span> = (<span class="id" title="var">c</span> * <span class="id" title="var">b</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_mult_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_neq_0_compat</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rdiv_inver_f</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span> / <span class="id" title="var">b</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">c</span> / <span class="id" title="var">d</span>)%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">b</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">d</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; (<span class="id" title="var">a</span> * <span class="id" title="var">d</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">c</span> * <span class="id" title="var">b</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rdiv_inver_l</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b</span> := <span class="id" title="var">b</span>) (<span class="id" title="var">c</span> := (<span class="id" title="var">c</span> / <span class="id" title="var">d</span>)%<span class="id" title="var">R</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : (<span class="id" title="var">c</span> * / <span class="id" title="var">d</span> * <span class="id" title="var">b</span> * <span class="id" title="var">d</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">c</span> * <span class="id" title="var">b</span> * (/ <span class="id" title="var">d</span> * <span class="id" title="var">d</span>))%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>; <span class="id" title="var">lra</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rdiv_inver_f_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span> * <span class="id" title="var">d</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">c</span> * <span class="id" title="var">b</span>)%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">b</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <span class="id" title="var">d</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; (<span class="id" title="var">a</span> / <span class="id" title="var">b</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">c</span> / <span class="id" title="var">d</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_mult_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : (<span class="id" title="var">c</span> * <span class="id" title="var">b</span> * / <span class="id" title="var">d</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">c</span> * / <span class="id" title="var">d</span> * <span class="id" title="var">b</span>)%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_mult_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rinv_add</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span>/<span class="id" title="var">b</span>)%<span class="id" title="var">R</span> = (<span class="id" title="var">c</span>/<span class="id" title="var">d</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">a</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">b</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">d</span> -&gt;         <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span> /(<span class="id" title="var">a</span> + <span class="id" title="var">b</span>))%<span class="id" title="var">R</span> = (<span class="id" title="var">c</span>/(<span class="id" title="var">c</span> + <span class="id" title="var">d</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rdiv_inver_f</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rdiv_inver_f_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rmult_plus_distr_l</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rle</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rplus_lt_0_compat</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rle</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rplus_lt_0_compat</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rle</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rle</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Papus_3</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> <span class="id" title="var">u1</span> <span class="id" title="var">v1</span> <span class="id" title="var">r1</span> <span class="id" title="var">s1</span>: <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">R'</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> <span class="id" title="var">E</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt; (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> <span class="id" title="var">u1</span> <span class="id" title="var">v1</span> <span class="id" title="var">r1</span> <span class="id" title="var">s1</span> -&gt; (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span> = ((<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> / <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> / <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>,<span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pappus_div</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r1</span> := <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>) (<span class="id" title="var">r2</span>:= <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>) (<span class="id" title="var">r3</span>:= <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_abs</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span> := <span class="id" title="var">Q</span>) (<span class="id" title="var">B</span> := <span class="id" title="var">E</span>) (<span class="id" title="var">C</span> := <span class="id" title="var">C</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, <span class="id" title="var">H1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rabs_no_R0</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r</span>:= (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rabs_no_R0</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r</span>:= (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Papus_4</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> <span class="id" title="var">u1</span> <span class="id" title="var">v1</span> <span class="id" title="var">r1</span> <span class="id" title="var">s1</span>: <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">R'</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> <span class="id" title="var">E</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt; (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> <span class="id" title="var">u1</span> <span class="id" title="var">v1</span> <span class="id" title="var">r1</span> <span class="id" title="var">s1</span> -&gt; (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span> = ((<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> / (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> / (<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Papus_3</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">u</span>:=<span class="id" title="var">u</span>) (<span class="id" title="var">v</span>:=<span class="id" title="var">v</span>) (<span class="id" title="var">r</span>:=<span class="id" title="var">r</span>) (<span class="id" title="var">s'</span>:=<span class="id" title="var">s'</span>) (<span class="id" title="var">u1</span>:=<span class="id" title="var">u1</span>) (<span class="id" title="var">v1</span>:=<span class="id" title="var">v1</span>) (<span class="id" title="var">r1</span>:=<span class="id" title="var">r1</span>) (<span class="id" title="var">s1</span>:=<span class="id" title="var">s1</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pappus_REQ</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> <span class="id" title="var">u1</span> <span class="id" title="var">v1</span> <span class="id" title="var">r1</span> <span class="id" title="var">s1</span> <span class="id" title="var">u2</span> <span class="id" title="var">v2</span> <span class="id" title="var">r2</span> <span class="id" title="var">s2</span> <span class="id" title="var">u3</span> <span class="id" title="var">v3</span> <span class="id" title="var">r3</span> <span class="id" title="var">s3</span> : <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">R'</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> <span class="id" title="var">E</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> <span class="id" title="var">u1</span> <span class="id" title="var">v1</span> <span class="id" title="var">r1</span> <span class="id" title="var">s1</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> <span class="id" title="var">u2</span> <span class="id" title="var">v2</span> <span class="id" title="var">r2</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">u3</span> <span class="id" title="var">v3</span> <span class="id" title="var">r3</span> <span class="id" title="var">s3</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>  = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Papus_4</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">R'</span>:=<span class="id" title="var">R'</span>) (<span class="id" title="var">u</span>:=<span class="id" title="var">u</span>) (<span class="id" title="var">v</span>:=<span class="id" title="var">v</span>) (<span class="id" title="var">r</span>:=<span class="id" title="var">r</span>) (<span class="id" title="var">s'</span>:=<span class="id" title="var">s'</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">distance_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">distance_eq</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">R'</span>) (<span class="id" title="var">B</span>:= <span class="id" title="var">C</span>)<span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">distance_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>, <span class="id" title="var">H3</span>, <span class="id" title="var">H5</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">PAPPUS_REQ</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">R'</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> <span class="id" title="var">E</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>  = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">Pappus_REQ</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>; <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Papus_4'</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">u5</span> <span class="id" title="var">v5</span> <span class="id" title="var">r5</span> <span class="id" title="var">s5</span> <span class="id" title="var">u6</span> <span class="id" title="var">v6</span> <span class="id" title="var">r6</span> <span class="id" title="var">s6</span>: <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> <span class="id" title="var">A</span> <span class="id" title="var">u5</span> <span class="id" title="var">v5</span> <span class="id" title="var">r5</span> <span class="id" title="var">s5</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">F</span> <span class="id" title="var">u6</span> <span class="id" title="var">v6</span> <span class="id" title="var">r6</span> <span class="id" title="var">s6</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span> = ((<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> / (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> / (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>,<span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Pappus_div</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r1</span> := <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>) (<span class="id" title="var">r2</span>:= <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>) (<span class="id" title="var">r3</span>:= <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_abs</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span> := <span class="id" title="var">R'</span>) (<span class="id" title="var">B</span> := <span class="id" title="var">A</span>) (<span class="id" title="var">C</span> := <span class="id" title="var">F</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, <span class="id" title="var">H1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rabs_no_R0</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r</span>:= (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rabs_no_R0</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r</span>:= (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pappus_QAR</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">u5</span> <span class="id" title="var">v5</span> <span class="id" title="var">r5</span> <span class="id" title="var">s5</span> <span class="id" title="var">u6</span> <span class="id" title="var">v6</span> <span class="id" title="var">r6</span> <span class="id" title="var">s6</span> <span class="id" title="var">u7</span> <span class="id" title="var">v7</span> <span class="id" title="var">r7</span> <span class="id" title="var">s7</span> <span class="id" title="var">u8</span> <span class="id" title="var">v8</span> <span class="id" title="var">r8</span> <span class="id" title="var">s8</span> : <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> <span class="id" title="var">A</span> <span class="id" title="var">u5</span> <span class="id" title="var">v5</span> <span class="id" title="var">r5</span> <span class="id" title="var">s5</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">F</span> <span class="id" title="var">u6</span> <span class="id" title="var">v6</span> <span class="id" title="var">r6</span> <span class="id" title="var">s6</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">Q</span> <span class="id" title="var">u7</span> <span class="id" title="var">v7</span> <span class="id" title="var">r7</span> <span class="id" title="var">s7</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> <span class="id" title="var">u8</span> <span class="id" title="var">v8</span> <span class="id" title="var">r8</span> <span class="id" title="var">s8</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>  =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Papus_4'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">Q</span>:=<span class="id" title="var">Q</span>) (<span class="id" title="var">u5</span>:= <span class="id" title="var">u5</span>) (<span class="id" title="var">v5</span>:=<span class="id" title="var">v5</span>) (<span class="id" title="var">r5</span>:=<span class="id" title="var">r5</span>) (<span class="id" title="var">s5</span>:=<span class="id" title="var">s5</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">distance_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. &nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">distance_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>, <span class="id" title="var">H3</span>, <span class="id" title="var">H5</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">PAPPUS_QAR</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">F</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">Q</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>  =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span>)) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">Pappus_QAR</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>; <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>. <span class="id" title="tactic">exact</span> 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Pappus_omega</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">c</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span> <span class="id" title="var">e</span> <span class="id" title="var">f1</span> <span class="id" title="var">f2</span>: <span class="id" title="var">R</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> = ((<span class="id" title="var">b1</span>/<span class="id" title="var">c</span>)%<span class="id" title="var">R</span> * (<span class="id" title="var">d1</span>/<span class="id" title="var">e</span>)%<span class="id" title="var">R</span> * <span class="id" title="var">f1</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> = ((<span class="id" title="var">b2</span>/<span class="id" title="var">e</span>)%<span class="id" title="var">R</span> * (<span class="id" title="var">d2</span>/<span class="id" title="var">c</span>)%<span class="id" title="var">R</span> * <span class="id" title="var">f2</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">e</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a2</span> &lt;&gt; 0%<span class="id" title="var">R</span>-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">d2</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f2</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b2</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a1</span>/<span class="id" title="var">a2</span>)%<span class="id" title="var">R</span> = ((<span class="id" title="var">f1</span>/<span class="id" title="var">d2</span>)%<span class="id" title="var">R</span>*(<span class="id" title="var">d1</span>/<span class="id" title="var">f2</span>)%<span class="id" title="var">R</span>*(<span class="id" title="var">b1</span>/<span class="id" title="var">b2</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_mult_distr</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_mult_distr</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_mult_distr</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_mult_distr</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : (<span class="id" title="var">b1</span> * / <span class="id" title="var">c</span> * (<span class="id" title="var">d1</span> * / <span class="id" title="var">e</span>) * <span class="id" title="var">f1</span> * (/ <span class="id" title="var">b2</span> * <span class="id" title="var">e</span> * (/ <span class="id" title="var">d2</span> * <span class="id" title="var">c</span>) * / <span class="id" title="var">f2</span>))%<span class="id" title="var">R</span>=<br/>
&nbsp;&nbsp;(<span class="id" title="var">b1</span> * (<span class="id" title="var">c</span> * / <span class="id" title="var">c</span>) * (<span class="id" title="var">d1</span> * (<span class="id" title="var">e</span> */ <span class="id" title="var">e</span>)) * <span class="id" title="var">f1</span> * / <span class="id" title="var">b2</span> * (/ <span class="id" title="var">d2</span> * / <span class="id" title="var">f2</span>))%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>, <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>, <span class="id" title="var">H2</span>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_neq_0_compat</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_neq_0_compat</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rmult_integral_contrapositive_currified</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_neq_0_compat</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rmult_integral_contrapositive_currified</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_neq_0_compat</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">apply</span> <span class="id" title="var">Rmult_integral_contrapositive_currified</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_neq_0_compat</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_neq_0_compat</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">Pappus</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> <span class="id" title="var">u1</span> <span class="id" title="var">v1</span> <span class="id" title="var">r1</span> <span class="id" title="var">s1</span> <span class="id" title="var">u2</span> <span class="id" title="var">v2</span> <span class="id" title="var">r2</span> <span class="id" title="var">s2</span> <span class="id" title="var">u3</span> <span class="id" title="var">v3</span> <span class="id" title="var">r3</span> <span class="id" title="var">s3</span> <span class="id" title="var">u5</span> <span class="id" title="var">v5</span> <span class="id" title="var">r5</span> <span class="id" title="var">s5</span> <span class="id" title="var">u6</span> <span class="id" title="var">v6</span> <span class="id" title="var">r6</span> <span class="id" title="var">s6</span> <span class="id" title="var">u7</span> <span class="id" title="var">v7</span> <span class="id" title="var">r7</span> <span class="id" title="var">s7</span> <span class="id" title="var">u8</span> <span class="id" title="var">v8</span> <span class="id" title="var">r8</span> <span class="id" title="var">s8</span> <span class="id" title="var">u9</span> <span class="id" title="var">v9</span> <span class="id" title="var">r9</span> <span class="id" title="var">s9</span> <span class="id" title="var">u0</span> <span class="id" title="var">v0</span> <span class="id" title="var">r0</span> <span class="id" title="var">s0</span> <span class="id" title="var">u10</span> <span class="id" title="var">v10</span> <span class="id" title="var">r10</span> <span class="id" title="var">s10</span> <span class="id" title="var">u11</span> <span class="id" title="var">v11</span> <span class="id" title="var">r11</span> <span class="id" title="var">s11</span> <span class="id" title="var">u12</span> <span class="id" title="var">v12</span> <span class="id" title="var">r12</span> <span class="id" title="var">s12</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>: <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">R'</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> <span class="id" title="var">E</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">s'</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> <span class="id" title="var">u1</span> <span class="id" title="var">v1</span> <span class="id" title="var">r1</span> <span class="id" title="var">s1</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> <span class="id" title="var">u2</span> <span class="id" title="var">v2</span> <span class="id" title="var">r2</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> <span class="id" title="var">u3</span> <span class="id" title="var">v3</span> <span class="id" title="var">r3</span> <span class="id" title="var">s3</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> <span class="id" title="var">A</span> <span class="id" title="var">u5</span> <span class="id" title="var">v5</span> <span class="id" title="var">r5</span> <span class="id" title="var">s5</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">F</span> <span class="id" title="var">u6</span> <span class="id" title="var">v6</span> <span class="id" title="var">r6</span> <span class="id" title="var">s6</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">Q</span> <span class="id" title="var">u7</span> <span class="id" title="var">v7</span> <span class="id" title="var">r7</span> <span class="id" title="var">s7</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> <span class="id" title="var">u8</span> <span class="id" title="var">v8</span> <span class="id" title="var">r8</span> <span class="id" title="var">s8</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">F</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">E</span> <span class="id" title="var">u9</span> <span class="id" title="var">v9</span> <span class="id" title="var">r9</span> <span class="id" title="var">s9</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">E</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">D</span> <span class="id" title="var">P</span> <span class="id" title="var">u0</span> <span class="id" title="var">v0</span> <span class="id" title="var">r0</span> <span class="id" title="var">s0</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>) + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>) + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>) + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t1</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t2</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">u10</span> <span class="id" title="var">v10</span> <span class="id" title="var">r10</span> <span class="id" title="var">s10</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">u11</span> <span class="id" title="var">v11</span> <span class="id" title="var">r11</span> <span class="id" title="var">s11</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Xcollin0</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">u12</span> <span class="id" title="var">v12</span> <span class="id" title="var">r12</span> <span class="id" title="var">s12</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(/ <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span>))%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(/ <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(/ <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span> = ((<span class="id" title="var">distance</span> <span class="id" title="var">P</span> <span class="id" title="var">E</span>) / (<span class="id" title="var">distance</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Pappus_REQ</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>) (<span class="id" title="var">C</span>:=<span class="id" title="var">C</span>) (<span class="id" title="var">D</span>:=<span class="id" title="var">D</span>) (<span class="id" title="var">E</span>:=<span class="id" title="var">E</span>) (<span class="id" title="var">F</span>:=<span class="id" title="var">F</span>) (<span class="id" title="var">Q</span>:=<span class="id" title="var">Q</span>) (<span class="id" title="var">R'</span>:= <span class="id" title="var">R'</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">u</span>:=<span class="id" title="var">u</span>) (<span class="id" title="var">v</span>:=<span class="id" title="var">v</span>) (<span class="id" title="var">r</span>:=<span class="id" title="var">r</span>) (<span class="id" title="var">s'</span>:=<span class="id" title="var">s'</span>) (<span class="id" title="var">u1</span>:=<span class="id" title="var">u1</span>) (<span class="id" title="var">v1</span>:=<span class="id" title="var">v1</span>) (<span class="id" title="var">r1</span>:=<span class="id" title="var">r1</span>) (<span class="id" title="var">s1</span>:=<span class="id" title="var">s1</span>) (<span class="id" title="var">u2</span>:=<span class="id" title="var">u2</span>) (<span class="id" title="var">v2</span>:=<span class="id" title="var">v2</span>) (<span class="id" title="var">r2</span>:=<span class="id" title="var">r2</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">s2</span>:=<span class="id" title="var">s2</span>) (<span class="id" title="var">u3</span>:=<span class="id" title="var">u3</span>) (<span class="id" title="var">v3</span>:=<span class="id" title="var">v3</span>) (<span class="id" title="var">r3</span>:=<span class="id" title="var">r3</span>) (<span class="id" title="var">s3</span>:=<span class="id" title="var">s3</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Pappus_QAR</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>)(<span class="id" title="var">C</span>:=<span class="id" title="var">C</span>) (<span class="id" title="var">D</span>:=<span class="id" title="var">D</span>) (<span class="id" title="var">E</span>:=<span class="id" title="var">E</span>) (<span class="id" title="var">F</span>:=<span class="id" title="var">F</span>) (<span class="id" title="var">Q</span>:=<span class="id" title="var">Q</span>) (<span class="id" title="var">R'</span>:= <span class="id" title="var">R'</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">u5</span>:=<span class="id" title="var">u5</span>) (<span class="id" title="var">v5</span>:=<span class="id" title="var">v5</span>) (<span class="id" title="var">r5</span>:=<span class="id" title="var">r5</span>) (<span class="id" title="var">s5</span>:=<span class="id" title="var">s5</span>) (<span class="id" title="var">u6</span>:=<span class="id" title="var">u6</span>) (<span class="id" title="var">v6</span>:=<span class="id" title="var">v6</span>) (<span class="id" title="var">r6</span>:=<span class="id" title="var">r6</span>) (<span class="id" title="var">s6</span>:=<span class="id" title="var">s6</span>) (<span class="id" title="var">u7</span>:=<span class="id" title="var">u7</span>) (<span class="id" title="var">v7</span>:=<span class="id" title="var">v7</span>) (<span class="id" title="var">r7</span>:=<span class="id" title="var">r7</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">s7</span>:=<span class="id" title="var">s7</span>) (<span class="id" title="var">u8</span>:=<span class="id" title="var">u8</span>) (<span class="id" title="var">v8</span>:=<span class="id" title="var">v8</span>) (<span class="id" title="var">r8</span>:=<span class="id" title="var">r8</span>) (<span class="id" title="var">s8</span>:=<span class="id" title="var">s8</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span>: ((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H39</span>, <span class="id" title="var">H41</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H40</span>, <span class="id" title="var">H42</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Pappus_omega</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">c</span>:=<span class="id" title="var">t1</span>) (<span class="id" title="var">e</span>:=<span class="id" title="var">t2</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H17</span>,<span class="id" title="var">H49</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H17</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_abs'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H49</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H17</span>, <span class="id" title="var">H49</span>. <span class="id" title="tactic">apply</span>  <span class="id" title="var">Rinv_mult_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H17</span>, <span class="id" title="var">H49</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H51</span>, <span class="id" title="var">H53</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_abs''</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">F</span>)<span class="id" title="tactic">in</span> <span class="id" title="var">H51</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H51</span>, <span class="id" title="var">H53</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">commonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H19</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H17</span>, <span class="id" title="var">H49</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_mult_distr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_mult_distr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs'</span> : (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> * (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> * <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(/ <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> * <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>))))%<span class="id" title="var">R</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span>) * (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span>) * (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) * (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span>) * (<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span>) * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>)))%<span class="id" title="var">R</span>).<br/>
<span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H56</span>, <span class="id" title="var">H57</span>, <span class="id" title="var">H58</span>, <span class="id" title="var">H59</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H56</span>, <span class="id" title="var">H57</span>, <span class="id" title="var">H58</span>, <span class="id" title="var">H59</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hs</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H19</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H19</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_abs'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">B</span>).<br/>
<span class="id" title="var">lra</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">PAPPUS</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span>:<span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">R'</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> <span class="id" title="var">E</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">C</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">Q</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">F</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">Q</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">F</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">E</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">E</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">D</span> <span class="id" title="var">P</span>  -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> + <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">B</span> = (<span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> + <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">C</span> <span class="id" title="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">F</span> <span class="id" title="var">R'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">R'</span> <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0%<span class="id" title="var">R</span> &lt; <span class="id" title="var">distance</span> <span class="id" title="var">Q</span> <span class="id" title="var">F</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>) + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>) + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">t1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>) + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) + <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> = <span class="id" title="var">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t1</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t2</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">D</span> <span class="id" title="var">F</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">XCOLLIN</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(/ <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span>))%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(/ <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>))%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(/ <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span>) &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">D</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span> &lt;&gt; 0%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span> = ((<span class="id" title="var">distance</span> <span class="id" title="var">P</span> <span class="id" title="var">E</span>) / (<span class="id" title="var">distance</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span>))%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">PAPPUS_REQ</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>) (<span class="id" title="var">C</span>:=<span class="id" title="var">C</span>) (<span class="id" title="var">D</span>:=<span class="id" title="var">D</span>) (<span class="id" title="var">E</span>:=<span class="id" title="var">E</span>) (<span class="id" title="var">F</span>:=<span class="id" title="var">F</span>) (<span class="id" title="var">Q</span>:=<span class="id" title="var">Q</span>) (<span class="id" title="var">R'</span>:= <span class="id" title="var">R'</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">PAPPUS_QAR</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>)(<span class="id" title="var">C</span>:=<span class="id" title="var">C</span>) (<span class="id" title="var">D</span>:=<span class="id" title="var">D</span>) (<span class="id" title="var">E</span>:=<span class="id" title="var">E</span>) (<span class="id" title="var">F</span>:=<span class="id" title="var">F</span>) (<span class="id" title="var">Q</span>:=<span class="id" title="var">Q</span>) (<span class="id" title="var">R'</span>:= <span class="id" title="var">R'</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span>: ((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">R'</span> <span class="id" title="var">E</span> <span class="id" title="var">Q</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">Q</span> <span class="id" title="var">A</span> <span class="id" title="var">R'</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">C</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">F</span> <span class="id" title="var">C</span> <span class="id" title="var">E</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">C</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span> <span class="id" title="var">F</span>)%<span class="id" title="var">R</span>)/(<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span>)%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H39</span>, <span class="id" title="var">H41</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H40</span>, <span class="id" title="var">H42</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Pappus_omega</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">c</span>:=<span class="id" title="var">t1</span>) (<span class="id" title="var">e</span>:=<span class="id" title="var">t2</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CommonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H17</span>,<span class="id" title="var">H49</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H17</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_abs'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H49</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H17</span>, <span class="id" title="var">H49</span>. <span class="id" title="tactic">apply</span>  <span class="id" title="var">Rinv_mult_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H17</span>, <span class="id" title="var">H49</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">CommonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H51</span>, <span class="id" title="var">H53</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_abs''</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">F</span>)<span class="id" title="tactic">in</span> <span class="id" title="var">H51</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H51</span>, <span class="id" title="var">H53</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CommonEdg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H19</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H17</span>, <span class="id" title="var">H49</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_mult_distr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_mult_distr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rinv_involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs'</span> : (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> * (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> * <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(/ <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> * <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>))))%<span class="id" title="var">R</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">F</span>) * (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span>) * (<span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> * / <span class="id" title="var">distance</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) * (<span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ <span class="id" title="var">distance</span> <span class="id" title="var">E</span> <span class="id" title="var">D</span>) * (<span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span> <span class="id" title="var">B</span>) * / <span class="id" title="var">Rabs</span> (<span class="id" title="var">s</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">D</span>)))%<span class="id" title="var">R</span>).<br/>
<span class="id" title="var">lra</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Rinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H56</span>, <span class="id" title="var">H57</span>, <span class="id" title="var">H58</span>, <span class="id" title="var">H59</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H56</span>, <span class="id" title="var">H57</span>, <span class="id" title="var">H58</span>, <span class="id" title="var">H59</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hs</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H19</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H19</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property11_abs'</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">B</span>).<br/>
<span class="id" title="var">lra</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Complex</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">CPmult</span> (<span class="id" title="var">z</span>: <span class="id" title="var">C</span>) (<span class="id" title="var">p</span>: <span class="id" title="var">Point</span>) : <span class="id" title="var">Point</span>:=<br/>
<span class="id" title="var">R_R_to_Point</span> (<span class="id" title="var">Cre</span> <span class="id" title="var">z</span> * <span class="id" title="var">Px</span> <span class="id" title="var">p</span> - <span class="id" title="var">Cim</span> <span class="id" title="var">z</span> * <span class="id" title="var">Py</span> <span class="id" title="var">p</span>) (<span class="id" title="var">Cre</span> <span class="id" title="var">z</span> * <span class="id" title="var">Py</span> <span class="id" title="var">p</span> + <span class="id" title="var">Cim</span> <span class="id" title="var">z</span> * <span class="id" title="var">Px</span> <span class="id" title="var">p</span>).<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">def6</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>: <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = (<span class="id" title="var">x</span>, <span class="id" title="var">y</span>) -&gt; <span class="id" title="var">CPmult</span> <span class="id" title="var">Ci</span> <span class="id" title="var">A</span> = ((-<span class="id" title="var">y</span>)%<span class="id" title="var">R</span>, <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>, <span class="id" title="var">Ci</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Peq</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">lra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property14</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">CPmult</span> <span class="id" title="var">Ci</span> (<span class="id" title="var">CPmult</span> <span class="id" title="var">Ci</span> <span class="id" title="var">A</span>) = - <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>, <span class="id" title="var">Ci</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property15</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span>: <span class="id" title="var">Point</span>, (<span class="id" title="var">CPmult</span> <span class="id" title="var">Ci</span> <span class="id" title="var">A</span>) · <span class="id" title="var">A</span> = 0%<span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>, <span class="id" title="var">Ci</span>, <span class="id" title="var">Pquantityprod</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">progress16</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">CPmult</span> <span class="id" title="var">Ci</span> <span class="id" title="var">A</span>) · <span class="id" title="var">B</span> = (-<span class="id" title="var">A</span>) · (<span class="id" title="var">CPmult</span> <span class="id" title="var">Ci</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>, <span class="id" title="var">Ci</span>, <span class="id" title="var">Pquantityprod</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Cexp</span>.<br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="var">Cexp</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PRotateO</span> (<span class="id" title="keyword">zeta</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span>: <span class="id" title="var">Point</span>):= <span class="id" title="var">CPmult</span> (<span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> <span class="id" title="keyword">zeta</span>)) <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property17</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="keyword">zeta</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">Point</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = (<span class="id" title="var">x</span>, <span class="id" title="var">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PRotateO</span> <span class="id" title="keyword">zeta</span> <span class="id" title="var">A</span> = ( (<span class="id" title="var">cos</span> <span class="id" title="keyword">zeta</span> * <span class="id" title="var">x</span> - <span class="id" title="var">sin</span> <span class="id" title="keyword">zeta</span> * <span class="id" title="var">y</span>)%<span class="id" title="var">R</span>, (<span class="id" title="var">cos</span> <span class="id" title="keyword">zeta</span> * <span class="id" title="var">y</span> + <span class="id" title="var">sin</span> <span class="id" title="keyword">zeta</span> * <span class="id" title="var">x</span>)%<span class="id" title="var">R</span>)%<span class="id" title="var">Point</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">PRotateO</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_trigo_compat</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PRotateB</span> (<span class="id" title="keyword">zeta</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>) := <span class="id" title="var">A'</span> = <span class="id" title="var">B</span> + <span class="id" title="var">CPmult</span> (<span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> <span class="id" title="keyword">zeta</span>)) (<span class="id" title="var">A</span> - <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property19'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">alpha</span> <span class="id" title="keyword">beta</span> <span class="id" title="var">A</span>, <span class="id" title="var">CPmult</span> (<span class="id" title="var">alpha</span> + <span class="id" title="keyword">beta</span>) <span class="id" title="var">A</span> = <span class="id" title="var">CPmult</span> <span class="id" title="var">alpha</span> <span class="id" title="var">A</span> + <span class="id" title="var">CPmult</span> <span class="id" title="keyword">beta</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property19''</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">alpha</span>: <span class="id" title="var">C</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">CPmult</span> <span class="id" title="var">alpha</span> (<span class="id" title="var">A</span> + <span class="id" title="var">B</span>) = <span class="id" title="var">CPmult</span> <span class="id" title="var">alpha</span> <span class="id" title="var">A</span> + <span class="id" title="var">CPmult</span> <span class="id" title="var">alpha</span> <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property19'''</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">alpha</span> <span class="id" title="keyword">beta</span>: <span class="id" title="var">C</span>) (<span class="id" title="var">A</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;<span class="id" title="var">CPmult</span> <span class="id" title="var">alpha</span> (<span class="id" title="var">CPmult</span> <span class="id" title="keyword">beta</span> <span class="id" title="var">A</span>) = <span class="id" title="var">CPmult</span> (<span class="id" title="var">alpha</span> * <span class="id" title="keyword">beta</span>) <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">property19_minus</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">alpha</span> <span class="id" title="keyword">beta</span> <span class="id" title="var">A</span>, <span class="id" title="var">CPmult</span> (<span class="id" title="var">alpha</span> - <span class="id" title="keyword">beta</span>) <span class="id" title="var">A</span> = <span class="id" title="var">CPmult</span> <span class="id" title="var">alpha</span> <span class="id" title="var">A</span> - <span class="id" title="var">CPmult</span> <span class="id" title="keyword">beta</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">triangle0</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">alpha</span> <span class="id" title="keyword">beta</span>: <span class="id" title="var">R</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">A</span> &lt;&gt; <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">B</span> &lt;&gt; <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">A</span> &lt;&gt; <span class="id" title="var">C</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">ASA</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">r</span>: <span class="id" title="var">R</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triangle0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">C</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> + <span class="id" title="var">CPmult</span> ((1 - <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> -2*<span class="id" title="var">b</span>))/(1 - <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> -2*(<span class="id" title="var">a</span>+<span class="id" title="var">b</span>)))) (<span class="id" title="var">B</span>-<span class="id" title="var">A</span>)%<span class="id" title="var">Point</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">INC_2</span> : <span class="id" title="var">INC</span> 2%<span class="id" title="var">nat</span> = 2%<span class="id" title="var">R</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">CusingR</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">INC_3</span> : <span class="id" title="var">INC</span> 3%<span class="id" title="var">nat</span> = 3%<span class="id" title="var">R</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">CusingR</span>; <span class="id" title="var">lra</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cexp_mult_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">C</span>, <span class="id" title="var">Cexp</span> (2 * <span class="id" title="var">a</span>) = (<span class="id" title="var">Cexp</span> <span class="id" title="var">a</span>) ^ 2.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">INC_2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_mult</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cexp_mult_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">C</span>, <span class="id" title="var">Cexp</span> (3 * <span class="id" title="var">a</span>) = (<span class="id" title="var">Cexp</span> <span class="id" title="var">a</span>) ^ 3.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">INC_3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_mult</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cexp_PI</span> : <span class="id" title="var">Cexp</span> (3 * (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3))%<span class="id" title="var">C</span>) = (<span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span>)%<span class="id" title="var">C</span>) ^ 3.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">INC_3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_mult</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cexp_PI3</span> : <span class="id" title="var">Cexp</span> (2 * (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3))%<span class="id" title="var">C</span>) = (<span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span>)%<span class="id" title="var">C</span>) ^ 2.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">INC_2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_mult</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Exp_PI'</span> :  <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> -4 * <span class="id" title="var">PI</span> / 3) = <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (2 * <span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span>). <span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hr</span> : 0 +<span class="id" title="var">i</span> (2 * <span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span> = (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span> - <span class="id" title="var">PI</span> / 3))). <span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_trigo_compat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : (-4 * <span class="id" title="var">PI</span> / 3)%<span class="id" title="var">R</span> = (-(<span class="id" title="var">PI</span> + (<span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span>))%<span class="id" title="var">R</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">Rdiv</span>. <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">cos_sym</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">sin_antisym</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span>:= ( (<span class="id" title="var">PI</span> + <span class="id" title="var">PI</span>/ 3))%<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rtrigo_facts.cos_pi_plus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rtrigo_facts.cos_pi_minus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rtrigo_facts.sin_pi_plus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Rtrigo_facts.sin_pi_minus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Exp_PI</span> :  <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> -4 * <span class="id" title="var">PI</span> / 3) = <span class="id" title="var">Cexp</span> (2 * (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : 2 * (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span>) = 0 +<span class="id" title="var">i</span> (2 * <span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span> ). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Exp_PI'</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CPmultdiv</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">c</span> : <span class="id" title="var">C</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c</span> &lt;&gt; 0 -&gt; <span class="id" title="var">CPmult</span> (1/<span class="id" title="var">c</span>) (<span class="id" title="var">CPmult</span> <span class="id" title="var">c</span> <span class="id" title="var">P</span>) = <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property19'''</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Cinv_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_1_l</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CPmultdiv_d'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span>: <span class="id" title="var">C</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">CPmult</span> (<span class="id" title="var">p</span>/<span class="id" title="var">q</span>) <span class="id" title="var">B</span> -&gt; <span class="id" title="var">p</span>/<span class="id" title="var">q</span> &lt;&gt; 0 -&gt; <span class="id" title="var">B</span> = <span class="id" title="var">CPmult</span> (1/(<span class="id" title="var">p</span>/<span class="id" title="var">q</span>)) <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">CPmultdiv</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cdiver</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">C</span>, <span class="id" title="var">p</span> &lt;&gt; 0 -&gt; <span class="id" title="var">q</span> &lt;&gt; 0 -&gt; 1/(<span class="id" title="var">p</span>/<span class="id" title="var">q</span>) = <span class="id" title="var">q</span>/<span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cinv_mult_distr</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cinv_involutive</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_1_l</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_comm</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Cinv_neq_0_compat</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CPmultdiv_d</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span>: <span class="id" title="var">C</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">CPmult</span> (<span class="id" title="var">p</span>/<span class="id" title="var">q</span>) <span class="id" title="var">B</span> -&gt; <span class="id" title="var">p</span>&lt;&gt; 0 -&gt; <span class="id" title="var">q</span> &lt;&gt; 0 -&gt; <span class="id" title="var">B</span> = <span class="id" title="var">CPmult</span> (<span class="id" title="var">q</span>/<span class="id" title="var">p</span>) <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cdiver</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">CPmultdiv_d'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Cmult_integral_contrapositive_currified</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Cinv_neq_0_compat</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CPmult_sub1</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">P1</span> <span class="id" title="var">P2</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">c1</span>: <span class="id" title="var">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P1</span> = <span class="id" title="var">CPmult</span> <span class="id" title="var">c1</span> <span class="id" title="var">P2</span> -&gt; (<span class="id" title="var">P1</span> - <span class="id" title="var">P2</span>)%<span class="id" title="var">Point</span> = <span class="id" title="var">CPmult</span> (<span class="id" title="var">c1</span> - 1) <span class="id" title="var">P2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CPmult_mult</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span>: <span class="id" title="var">C</span>) (<span class="id" title="var">Q</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Q</span> = <span class="id" title="var">CPmult</span> <span class="id" title="var">a</span> <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C</span> = <span class="id" title="var">CPmult</span> <span class="id" title="var">b</span> <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Q</span> = <span class="id" title="var">CPmult</span> (<span class="id" title="var">a</span>*<span class="id" title="var">b</span>) <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>, <span class="id" title="var">H0</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cmult_frac</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> : <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> &lt;&gt; 0 -&gt; <span class="id" title="var">d</span> &lt;&gt; 0 -&gt; (<span class="id" title="var">a</span>/<span class="id" title="var">b</span>) * (<span class="id" title="var">c</span>/<span class="id" title="var">d</span>) = (<span class="id" title="var">a</span>*<span class="id" title="var">c</span>) / (<span class="id" title="var">b</span>*<span class="id" title="var">d</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cinv_mult_distr</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cmult_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Cmult_eq_compat_r</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Cmult_eq_compat_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Cmult_comm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CPmult_mult_frac</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>: <span class="id" title="var">C</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">CPmult</span> (<span class="id" title="var">a</span>/<span class="id" title="var">b</span>) <span class="id" title="var">C</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C</span> = <span class="id" title="var">CPmult</span> (<span class="id" title="var">c</span>/<span class="id" title="var">d</span>) <span class="id" title="var">B</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">d</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">CPmult</span> ((<span class="id" title="var">a</span>*<span class="id" title="var">c</span>)/(<span class="id" title="var">b</span>*<span class="id" title="var">d</span>)) <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cmult_frac</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CPmult_mult</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">Q</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>) (<span class="id" title="var">C</span>:=<span class="id" title="var">C</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cexp_w3</span> : (<span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3)))^3 = (-1)%<span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cexp_PI</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : (3 * (0 +<span class="id" title="var">i</span> <span class="id" title="var">PI</span> / 3))= 0 +<span class="id" title="var">i</span> <span class="id" title="var">PI</span> ). <span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_trigo_compat</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">sin_PI</span>, <span class="id" title="var">cos_PI</span>; <span class="id" title="var">CusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cexp_w2</span> : (<span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3)))^2 = (<span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3))) -1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cexp_PI3</span>. <span class="id" title="keyword">Search</span> <span class="id" title="var">cos</span>. <span class="id" title="keyword">Print</span> <span class="id" title="var">cos_2PI3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs</span> : 2 * (0 +<span class="id" title="var">i</span> <span class="id" title="var">PI</span> / 3) = (0 +<span class="id" title="var">i</span> (2 * (<span class="id" title="var">PI</span> / 3)))). <span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_trigo_compat</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">cos_2PI3</span>, <span class="id" title="var">sin_2PI3</span>, <span class="id" title="var">cos_PI3</span>, <span class="id" title="var">sin_PI3</span>. <span class="id" title="var">CusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cfrac_ab</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span>&lt;&gt;0 -&gt; <span class="id" title="var">b</span>/<span class="id" title="var">a</span> -1 = (<span class="id" title="var">b</span>-<span class="id" title="var">a</span>)/<span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Cinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_minus_distr_r</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cmult_frac1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> * (<span class="id" title="var">c</span>/<span class="id" title="var">b</span>) = (<span class="id" title="var">a</span> * <span class="id" title="var">c</span>)/<span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_assoc</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cmult_fraca</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span>&lt;&gt;0 -&gt; <span class="id" title="var">c</span> &lt;&gt; 0 -&gt; <span class="id" title="var">b</span>/<span class="id" title="var">c</span> = (<span class="id" title="var">a</span>*<span class="id" title="var">b</span>)/(<span class="id" title="var">a</span>*<span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="keyword">Search</span> <span class="id" title="var">Cinv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cinv_mult_distr</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cmult_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Cmult_eq_compat_r</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_comm</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cmult_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Cinv_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cmult_fraca'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> &lt;&gt; 0 -&gt; <span class="id" title="var">b</span> = (<span class="id" title="var">b</span>*<span class="id" title="var">a</span>)/<span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Cinv_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="var">CusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Cmult_frac_eq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> &lt;&gt; 0 -&gt; <span class="id" title="var">a</span> + <span class="id" title="var">c</span>/<span class="id" title="var">b</span> = (<span class="id" title="var">a</span>*<span class="id" title="var">b</span> +<span class="id" title="var">c</span>)/<span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cmult_fraca_r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span>&lt;&gt;0 -&gt; <span class="id" title="var">c</span> &lt;&gt; 0 -&gt; <span class="id" title="var">b</span>/<span class="id" title="var">c</span> = (<span class="id" title="var">b</span>*<span class="id" title="var">a</span>)/(<span class="id" title="var">c</span>*<span class="id" title="var">a</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_comm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_comm</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">z1</span>:=<span class="id" title="var">c</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">Cmult_fraca</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cfrac_minus</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span>/<span class="id" title="var">c</span> - <span class="id" title="var">b</span>/<span class="id" title="var">c</span> = (<span class="id" title="var">a</span>-<span class="id" title="var">b</span>)/<span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_minus_distr_r</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cfrac_add</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span>/<span class="id" title="var">c</span> + <span class="id" title="var">b</span>/<span class="id" title="var">c</span> = (<span class="id" title="var">a</span>+<span class="id" title="var">b</span>)/<span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Cdiv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_add_distr_r</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CPmult_P</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">P</span>: <span class="id" title="var">Point</span>, <span class="id" title="var">P</span> = <span class="id" title="var">CPmult</span> 1 <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mor_H3</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">c</span> : <span class="id" title="var">C</span>) (<span class="id" title="var">B</span>: <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">B</span> + <span class="id" title="var">CPmult</span> <span class="id" title="var">c</span> <span class="id" title="var">B</span> = <span class="id" title="var">CPmult</span> (1+<span class="id" title="var">c</span>) <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">CPmult</span>. <span class="id" title="var">PusingR_f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ccons_eq</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">c1</span> <span class="id" title="var">c2</span> : <span class="id" title="var">C</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">Point</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c1</span> = <span class="id" title="var">c2</span> -&gt; <span class="id" title="var">CPmult</span> <span class="id" title="var">c1</span> <span class="id" title="var">P</span> = <span class="id" title="var">CPmult</span> <span class="id" title="var">c2</span> <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cfrac_eq</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>: <span class="id" title="var">C</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> = <span class="id" title="var">b</span> -&gt; <span class="id" title="var">a</span>/<span class="id" title="var">c</span> = <span class="id" title="var">b</span>/<span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">Morley</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C'</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R'</span>: <span class="id" title="var">Point</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">r</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">w</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>: <span class="id" title="var">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">A</span> = <span class="id" title="var">O</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triangle0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C'</span> (3*<span class="id" title="var">a</span>)%<span class="id" title="var">R</span> (3*<span class="id" title="var">b</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triangle0</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">R'</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triangle0</span> <span class="id" title="var">A</span> <span class="id" title="var">Q</span> <span class="id" title="var">C'</span> <span class="id" title="var">a</span> (<span class="id" title="var">PI</span>-<span class="id" title="var">a</span>-<span class="id" title="var">r</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triangle0</span> <span class="id" title="var">B</span> <span class="id" title="var">C'</span> <span class="id" title="var">P</span> <span class="id" title="var">b</span> <span class="id" title="var">r</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> = <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (<span class="id" title="var">PI</span>/3)%<span class="id" title="var">R</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">u</span> = <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (-2*<span class="id" title="var">a</span>)%<span class="id" title="var">R</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">v</span> = <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> (-2*<span class="id" title="var">b</span>)%<span class="id" title="var">R</span>)-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">r</span> = (<span class="id" title="var">PI</span>/3 - <span class="id" title="var">a</span> - <span class="id" title="var">b</span>)%<span class="id" title="var">R</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3 &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) * ((1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>)) &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) * ((1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>)) &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1 &lt;&gt; 0-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>) &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">v</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) * (1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3) &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> - <span class="id" title="var">v</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3 &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Cexp</span> (2 * (0 +<span class="id" title="var">i</span> <span class="id" title="var">PI</span> / 3) + (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">a</span>) + (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">b</span>)) &lt;&gt; 0 -&gt;<br/>
&nbsp;1 - <span class="id" title="var">Cexp</span> (0 +<span class="id" title="var">i</span> -2 * (<span class="id" title="var">b</span> + (<span class="id" title="var">PI</span> / 3 - <span class="id" title="var">a</span> - <span class="id" title="var">b</span>))) &lt;&gt; 0 -&gt;<br/>
1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3 &lt;&gt; 0 -&gt;<br/>
<br/>
&nbsp;<span class="id" title="var">C'</span> = <span class="id" title="var">CPmult</span> ((1 - <span class="id" title="var">v</span> ^ 3) / (1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3)) <span class="id" title="var">B</span> -&gt;<br/>
<br/>
&nbsp;1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span> &lt;&gt; 0 -&gt;<br/>
&nbsp;1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3 &lt;&gt; 0 -&gt;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">CPmult</span> <span class="id" title="var">w</span> <span class="id" title="var">Q</span>) - <span class="id" title="var">R'</span>)%<span class="id" title="var">Point</span> = <span class="id" title="var">CPmult</span> (<span class="id" title="var">w</span>^2) <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ASA</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>, <span class="id" title="var">H1</span>, <span class="id" title="var">H2</span>, <span class="id" title="var">H3</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">Oelim</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hab</span> : (0 +<span class="id" title="var">i</span> -2 * (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>))= (0 +<span class="id" title="var">i</span> -2*<span class="id" title="var">a</span>) + (0 +<span class="id" title="var">i</span> -2*<span class="id" title="var">b</span>)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hab</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H5</span>, &lt;- <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H3b</span> : (0 +<span class="id" title="var">i</span> -2 * (3 * <span class="id" title="var">b</span>)) = 3 * (0 +<span class="id" title="var">i</span> (-2*<span class="id" title="var">b</span>)%<span class="id" title="var">R</span>)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3b</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_mult_3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. 2: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H3ab</span> : 0 +<span class="id" title="var">i</span> -2*(3 * <span class="id" title="var">a</span> + 3 * <span class="id" title="var">b</span>) = 3*((0 +<span class="id" title="var">i</span> (-2*<span class="id" title="var">a</span>)%<span class="id" title="var">R</span>) + (0 +<span class="id" title="var">i</span> (-2*<span class="id" title="var">b</span>)%<span class="id" title="var">R</span>))). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3ab</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_mult_3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. 2: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H5</span>, &lt;- <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hpib</span> : (-2 * (<span class="id" title="var">PI</span> - <span class="id" title="var">a</span> - (<span class="id" title="var">PI</span>/3 - <span class="id" title="var">a</span> - <span class="id" title="var">b</span>)))%<span class="id" title="var">R</span> = (-4 * <span class="id" title="var">PI</span>/3 + (-2*<span class="id" title="var">b</span>))%<span class="id" title="var">R</span>). <span class="id" title="var">lra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hpib</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hipib</span> : (0 +<span class="id" title="var">i</span> -4 * <span class="id" title="var">PI</span> / 3 + -2 * <span class="id" title="var">b</span>) =(0 +<span class="id" title="var">i</span> -4 * <span class="id" title="var">PI</span> / 3) + (0 +<span class="id" title="var">i</span> (-2*<span class="id" title="var">b</span>)%<span class="id" title="var">R</span>) ). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hipib</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Exp_PI</span>, <span class="id" title="var">Cexp_mult_2</span>, &lt;- <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. 2: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Habr</span> : (0 +<span class="id" title="var">i</span> -2 * (<span class="id" title="var">a</span> + (<span class="id" title="var">PI</span> - <span class="id" title="var">a</span> - (<span class="id" title="var">PI</span> / 3 - <span class="id" title="var">a</span> - <span class="id" title="var">b</span>)))) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 +<span class="id" title="var">i</span> -4 * <span class="id" title="var">PI</span> / 3) + (0 +<span class="id" title="var">i</span> (-2*<span class="id" title="var">a</span>)%<span class="id" title="var">R</span>) + (0 +<span class="id" title="var">i</span> (-2*<span class="id" title="var">b</span>)%<span class="id" title="var">R</span>)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Habr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Exp_PI</span>, <span class="id" title="var">Cexp_mult_2</span>, &lt;- <span class="id" title="var">H4</span>, &lt;- <span class="id" title="var">H5</span>, &lt;- <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. 2: <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">CPmult_sub1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CPmultdiv_d</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">CPmult_mult_frac</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">A</span>:=<span class="id" title="var">Q</span>) (<span class="id" title="var">C</span>:= <span class="id" title="var">C'</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span>:=(1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span>)%<span class="id" title="var">C</span>) (<span class="id" title="var">b</span>:=(1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>)%<span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">c</span>:=(1 - <span class="id" title="var">v</span> ^ 3)%<span class="id" title="var">C</span>) (<span class="id" title="var">d</span>:=(1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3)%<span class="id" title="var">C</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cfrac_ab</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Huv</span> : (1 - <span class="id" title="var">v</span> ^ 3 - (1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3)) = ((<span class="id" title="var">v</span> ^ 3) * ((<span class="id" title="var">u</span>^3) -1))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Huv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property19'''</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hwq</span> : <span class="id" title="var">w</span> * ((1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span>) * (1 - <span class="id" title="var">v</span> ^ 3)) = (<span class="id" title="var">w</span> - <span class="id" title="var">w</span>^3 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> ) * (1 - <span class="id" title="var">v</span> ^ 3)).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hw3</span> : (<span class="id" title="var">w</span> - <span class="id" title="var">w</span> ^ 3 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span>) = <span class="id" title="var">w</span> + <span class="id" title="var">u</span> * <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_w3</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H4</span>. <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hw3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hwq</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_frac1</span>, <span class="id" title="var">Hwq</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">property19_minus</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H7</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_fraca</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span>:= <span class="id" title="var">Cexp</span> (2* (0 +<span class="id" title="var">i</span> <span class="id" title="var">PI</span> / 3) + ((0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">a</span>)) + ((0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">b</span>)))) <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_minus_distr_l</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">z1</span>:= <span class="id" title="var">Cexp</span> (2 * (0 +<span class="id" title="var">i</span> <span class="id" title="var">PI</span> / 3) + (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">a</span>) + (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">b</span>))) <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_1_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cexp_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hpab</span> : (2 * (0 +<span class="id" title="var">i</span> <span class="id" title="var">PI</span> / 3) + (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">a</span>) + (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">b</span>) + (0 +<span class="id" title="var">i</span> -2 * (<span class="id" title="var">PI</span> / 3 - <span class="id" title="var">a</span> - <span class="id" title="var">b</span>))) = 0). <span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hpab</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hpab2</span> : (2 * (0 +<span class="id" title="var">i</span> <span class="id" title="var">PI</span> / 3) + (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">a</span>) + (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">b</span>) + (0 +<span class="id" title="var">i</span> -2 * (<span class="id" title="var">b</span> + (<span class="id" title="var">PI</span> / 3 - <span class="id" title="var">a</span> - <span class="id" title="var">b</span>)))) = (0 +<span class="id" title="var">i</span> -2 * <span class="id" title="var">b</span>)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hpab2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_add</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>  <span class="id" title="var">Cexp_PI3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H4</span>, &lt;- <span class="id" title="var">H5</span>, &lt;- <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Search</span> <span class="id" title="var">Cexp</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cexp_0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hs</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">property19'''</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_frac</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Mor_H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hv3</span> : (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> - 1) * (<span class="id" title="var">v</span> ^ 3 * (<span class="id" title="var">u</span> ^ 3 - 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">v</span> * ((<span class="id" title="var">v</span> ^ 2) * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> - 1) *  (<span class="id" title="var">u</span> ^ 3 - 1))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hv3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hv</span> : ((<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> - <span class="id" title="var">v</span>) * (1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3)) = <span class="id" title="var">v</span> * ((<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) * (1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Cmult_fraca</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">property19'''</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_add_distr_l</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_1_r</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HW3</span> : <span class="id" title="var">w</span>^3=-1). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Cexp_w3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_frac1</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span> := <span class="id" title="var">w</span> ^ 2).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hw2</span> : <span class="id" title="var">w</span> ^ 2 * (<span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> - 1) * (<span class="id" title="var">u</span> ^ 3 - 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">w</span> ^ 3 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> - <span class="id" title="var">w</span>) * (<span class="id" title="var">u</span> ^ 3 - 1)).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hw2</span>, <span class="id" title="var">HW3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hsym</span> : <span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (-1 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> - <span class="id" title="var">w</span>) * (<span class="id" title="var">u</span> ^ 3 - 1) = <span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">w</span>) * (1 - <span class="id" title="var">u</span> ^ 3)).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hsym</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Ccons_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Huv3</span> : (1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3) = (1+<span class="id" title="var">u</span>*<span class="id" title="var">v</span>+<span class="id" title="var">u</span>^2*<span class="id" title="var">v</span>^2)*(1-<span class="id" title="var">u</span>*<span class="id" title="var">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Huv3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_fraca</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span>:=((1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b</span>:=(1 - <span class="id" title="var">v</span>)) (<span class="id" title="var">c</span>:=(1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hg</span> : ((1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>) * ((1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>))) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hg</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cfrac_minus</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span>:=(<span class="id" title="var">w</span>+<span class="id" title="var">u</span>*<span class="id" title="var">v</span>)*(1-<span class="id" title="var">v</span>^3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b</span>:=(1-<span class="id" title="var">w</span>^2*<span class="id" title="var">v</span>)*(1+<span class="id" title="var">u</span>*<span class="id" title="var">v</span>+<span class="id" title="var">u</span>^2*<span class="id" title="var">v</span>^2)*(1-<span class="id" title="var">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">c</span>:=((1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_fraca_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span>:= (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1)).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Heq2</span> : <span class="id" title="var">w</span>^2+<span class="id" title="var">w</span>*<span class="id" title="var">v</span>^2*(<span class="id" title="var">u</span>*<span class="id" title="var">v</span>+<span class="id" title="var">w</span>)*(1-<span class="id" title="var">u</span>^3)/((<span class="id" title="var">w</span>^2*<span class="id" title="var">u</span>-1)*((1+<span class="id" title="var">u</span>*<span class="id" title="var">v</span>+<span class="id" title="var">u</span>^2*<span class="id" title="var">v</span>^2)*(1-<span class="id" title="var">u</span>*<span class="id" title="var">v</span>)))=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span>^2*(<span class="id" title="var">w</span>^2*<span class="id" title="var">u</span>-1)*((1+<span class="id" title="var">u</span>*<span class="id" title="var">v</span>+<span class="id" title="var">u</span>^2*<span class="id" title="var">v</span>^2)*(1-<span class="id" title="var">u</span>*<span class="id" title="var">v</span>))+<span class="id" title="var">w</span>*<span class="id" title="var">v</span>^2*(<span class="id" title="var">u</span>*<span class="id" title="var">v</span>+<span class="id" title="var">w</span>)*(1-<span class="id" title="var">u</span>^3))/((<span class="id" title="var">w</span>^2*<span class="id" title="var">u</span>-1)*((1+<span class="id" title="var">u</span>*<span class="id" title="var">v</span>+<span class="id" title="var">u</span>^2*<span class="id" title="var">v</span>^2)*(1-<span class="id" title="var">u</span>*<span class="id" title="var">v</span>)))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_frac_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hequal</span> : (<span class="id" title="var">w</span> ^ 2 * ((<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) * ((1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>))) +<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">w</span>) * (1 - <span class="id" title="var">u</span> ^ 3)) = (<span class="id" title="var">w</span> ^ 2 * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) * ((1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">w</span>) * (1 - <span class="id" title="var">u</span> ^ 3))). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hequal</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heq2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_fraca_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span>:= (1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>))<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b</span>:= (<span class="id" title="var">w</span> ^ 2 * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) * ((1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">w</span>) * (1 - <span class="id" title="var">u</span> ^ 3))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hfe</span> : ((1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>) * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) * ((1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span>)) * (1 - <span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span>))).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hfe</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>  <span class="id" title="var">Cfrac_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hw32</span> : <span class="id" title="var">w</span> ^ 2 * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1) = <span class="id" title="var">w</span> * (<span class="id" title="var">w</span>^3 * <span class="id" title="var">u</span> - <span class="id" title="var">w</span>)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HW3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hw32</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hw33</span> : <span class="id" title="var">w</span> * (-1 * <span class="id" title="var">u</span> - <span class="id" title="var">w</span>) = -<span class="id" title="var">w</span> * (<span class="id" title="var">u</span> + <span class="id" title="var">w</span>)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hw33</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hw32</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hw32</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Huv3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_minus_distr_r</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq1</span> : (<span class="id" title="var">w</span> + <span class="id" title="var">u</span> * <span class="id" title="var">v</span>) * (1 - <span class="id" title="var">v</span> ^ 3) * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span> - 1)=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> ^ 3 * <span class="id" title="var">u</span> - <span class="id" title="var">w</span> ^ 3 * <span class="id" title="var">v</span> ^ 3 * <span class="id" title="var">u</span> - (<span class="id" title="var">w</span> - <span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 3) +<br/>
&nbsp;&nbsp;(<span class="id" title="var">u</span> * <span class="id" title="var">v</span> * 1 * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span>) - <span class="id" title="var">u</span> * <span class="id" title="var">v</span> * <span class="id" title="var">v</span> ^ 3 * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span>) - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span> * 1 - <span class="id" title="var">u</span> * <span class="id" title="var">v</span> * <span class="id" title="var">v</span> ^ 3)) ).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_add_distr_r</span>. <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_minus_distr_l</span>. <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_1_r</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_minus_distr_r</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_minus_distr_l</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_minus_distr_r</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq2</span> : <span class="id" title="var">w</span> * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span>) = <span class="id" title="var">w</span>^3 * <span class="id" title="var">u</span>). <span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hq2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq3</span> : <span class="id" title="var">w</span> * <span class="id" title="var">v</span>^3 * (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">u</span>) = <span class="id" title="var">w</span>^3 * <span class="id" title="var">v</span>^3 * <span class="id" title="var">u</span>). <span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hq3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hq1</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HW2</span> : <span class="id" title="var">w</span>^2 = <span class="id" title="var">w</span> -1). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Cexp_w2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HW3</span>, <span class="id" title="var">HW2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq4</span> : (1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">v</span>) * ((<span class="id" title="var">w</span> - 1) * <span class="id" title="var">u</span> - 1) = ((1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>) * ((<span class="id" title="var">w</span> - 1) * <span class="id" title="var">u</span> - 1)) * (1 + <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">u</span> ^ 2 * <span class="id" title="var">v</span> ^ 2) * (1 - <span class="id" title="var">v</span>)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq5</span> : ((1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>) * ((<span class="id" title="var">w</span> - 1) * <span class="id" title="var">u</span> - 1)) = <span class="id" title="var">w</span> * <span class="id" title="var">u</span> - <span class="id" title="var">u</span> - 1 - (<span class="id" title="var">w</span> ^ 2 * <span class="id" title="var">v</span> * <span class="id" title="var">u</span> - <span class="id" title="var">w</span> * <span class="id" title="var">v</span> * <span class="id" title="var">u</span> - <span class="id" title="var">w</span> * <span class="id" title="var">v</span> - <span class="id" title="var">w</span> * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">v</span> * <span class="id" title="var">u</span> + <span class="id" title="var">v</span>)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hq4</span>, <span class="id" title="var">Hq5</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HW2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Cmult_add_distr_r</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq6</span> : - <span class="id" title="var">w</span> * (<span class="id" title="var">u</span> + <span class="id" title="var">w</span>) * (1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3) * (1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(-<span class="id" title="var">w</span> * (<span class="id" title="var">u</span> + <span class="id" title="var">w</span>) * (1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>)) * (1 - (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) ^ 3)). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq7</span> : -<span class="id" title="var">w</span> * (<span class="id" title="var">u</span> + <span class="id" title="var">w</span>) * (1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-<span class="id" title="var">w</span> * <span class="id" title="var">u</span> - (<span class="id" title="var">w</span> * <span class="id" title="var">u</span> * <span class="id" title="var">v</span>- <span class="id" title="var">w</span>^2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span>) + (- (<span class="id" title="var">w</span>^2*<span class="id" title="var">v</span>- <span class="id" title="var">w</span>^3*<span class="id" title="var">v</span>)- <span class="id" title="var">w</span>^2)).<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hq6</span>, <span class="id" title="var">Hq7</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HW2</span>,<span class="id" title="var">HW3</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HQ8</span> : <span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">w</span>) * (1 - <span class="id" title="var">u</span> ^ 3) * (1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">w</span>) * (1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>)) * (1 - <span class="id" title="var">u</span> ^ 3)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HQ9</span> : <span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">u</span> * <span class="id" title="var">v</span> + <span class="id" title="var">w</span>) * (1 - (<span class="id" title="var">w</span> - 1) * <span class="id" title="var">v</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * <span class="id" title="var">u</span> * <span class="id" title="var">v</span> - (<span class="id" title="var">w</span>^2 * <span class="id" title="var">v</span>^4 * <span class="id" title="var">u</span> - <span class="id" title="var">w</span> * <span class="id" title="var">v</span> ^ 2 * (<span class="id" title="var">u</span> * <span class="id" title="var">v</span>) * <span class="id" title="var">v</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w</span>^2 * <span class="id" title="var">v</span> ^ 2  - (<span class="id" title="var">w</span>^3 * <span class="id" title="var">v</span>^2 * <span class="id" title="var">v</span> - <span class="id" title="var">w</span>^2 * <span class="id" title="var">v</span>^2 * <span class="id" title="var">v</span>))). <span class="id" title="var">CusingR_f</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HQ8</span>, <span class="id" title="var">HQ9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">HW3</span>,<span class="id" title="var">HW2</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">CusingR_f</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>